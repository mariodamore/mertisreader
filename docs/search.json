[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "install",
    "section": "",
    "text": "Import Required Libraries\n\nimport pathlib\nimport rich\nimport mertisreader as mr\n\nprint(\"Libraries imported successfully.\")\n\nLibraries imported successfully.\n\n\n\n\nInitialize the MERTISSessionReader with the input directory and optional parameters for output directory and log level.\nThe ../data/ contains a subset of the Moon flyby , technically called Earth Gravity Assist (EGA).\nThe directory name reflects ESA-PSA/PDS4 naminhc scheme and the start / stop data acquistion , plus the data pack creation.\nUnder this, there the different data levels :\n\n\n\n\n\n\n\n\n\n\nLevel\nUnits\nGeometry\nCalibration Targets\nTIS Aligned\n\n\n\n\nraw\nDigital Numbers\nNo\nNo\nNo\n\n\npar\nPhysical Units\nYes\nYes\nNo\n\n\ncal\nPhysical Units\nYes\nNo\nYes\n\n\n\n\nCalibration Target : if the currnet level contains calibration target measurements or only scientifically relevant one.\nTIS Aligned: : the TIS (Thermal Infrared Spectrometer) wavelength grid is aligned with the detector’s X and Y axes, so all pixels share the same wavelength grid. If not aligned, each pixel has its own wavelength grid, making data comparison and analysis more complex.\n\nJust change the level directory, the package can handle all the levels and read the data, take care of not calling geometry related paramter on RAW.\n\ninput_path = pathlib.Path('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal')\noutput_path = pathlib.Path('/tmp/')\nlog_level = 'INFO'\n\nif not input_path.exists():\n    print(f\"Input path {input_path} does not exist.\")\nelse:\n    print(f\"Reading path {input_path}\")\n\nms_reader = mr.MERTISDataPackReader(input_dir=input_path, output_dir=output_path, log_level=log_level)\n\nprint(f'MERTISDataPackReader initialized with input directory: {ms_reader.input_dir}')\nprint(f'Output directory: {ms_reader.output_dir}')\nprint(f'Log level: {ms_reader.log_level}')\n\n2025-10-02 16:44:54,927|452487|INFO|input_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal')\n\n\nReading path ../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal\nMERTISDataPackReader initialized with input directory: ../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal\nOutput directory: /tmp\nLog level: INFO\n\n\nShow Files in Input Directory\n\nms_reader.show_files()\n\nAll files in input_dir :\n\n\nCounter({'.dat': 2, '.lblx': 3, '.fits': 1})\n\n\n\nAll files in input_dir matching old pattern &lt;v0.2.6 (\\d{8}_\\d{8}):\n\n\nCounter()\n\n\n\nAll files in input_dir matching new pattern &gt;=v0.2.6 (mer_cal_sc_tis_YYYYMMDD_1-...):\n\n\nCounter({'mer_cal_sc_tis': 1})\n\n\n\nList File Types\n\nms_reader.listfiletypes()\n\n{\n    'hk_default': ['mer_cal_hk_default_20200409_1-0651130766-12538__0_1.dat'],\n    'hk_extended': ['mer_cal_hk_extended_20200409_1-0651130766-12595__0_1.dat'],\n    'sc_tis': ['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1.fits'],\n    'sc_tir': [],\n    'sc_tis_ql': [],\n    'sc_tir_ql': []\n}\n\n\n\n{'hk_default': 1, 'hk_extended': 1, 'sc_tis': 1, 'sc_tir': 0, 'sc_tis_ql': 0, 'sc_tir_ql': 0}\n\n\n\nCollect Data\n\nms_reader.data_collector()\n\nprint(f'Collected data keys: {ms_reader.collect_data.keys()}')\nfor key, value in ms_reader.collect_data.items():\n    print(f'{key}: {len(value)} files collected')\n\nReading filetype: hk_default from mer_cal_hk_default_20200409_1-0651130766-12538__0_1\nReading filetype: hk_extended from mer_cal_hk_extended_20200409_1-0651130766-12595__0_1\nReading filetype: tis from mer_cal_sc_tis_20200409_1-0651130819-21186__0_1\nCollected data keys: dict_keys(['hk_default', 'hk_extended', 'tis'])\nhk_default: 1 files collected\nhk_extended: 1 files collected\ntis: 1 files collected\n\n\nAssemble Data\n\nms_reader.data_assembler(verbose=True)\n\n\n\n\nReading filetype: tis from \n../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal/me\nr_cal_sc_tis_20200409_1-0651130819-21186__0_1.fits\n\n\n\n\n\n\nn_wav=40 # generic wavelengths : not precise enough for scientific analysis!\n|    | tis_stem                                        |   finite(geo) |   geo.size |\n|---:|:------------------------------------------------|--------------:|-----------:|\n|  0 | mer_cal_sc_tis_20200409_1-0651130819-21186__0_1 |           672 |      10500 |\nIndices of measurements targets (HK_STAT_TIS_DATA_ACQ_TARGET):\nspace_index_merged.shape=(21,)\nbb7_index_merged.shape=(0,)\nbb3_index_merged.shape=(0,)\nplanet_index_merged.shape=(0,)\nCollected data statistics:\nNumber of TIS files: 1\nNumber of HK files: 2\nNumber of TIR files: 0\nNumber of TIS QL files: 0\nNumber of TIR QL files: 0\n\n\nVerify the Assembled Data\n\n# RAW does not have geometry data\nif ms_reader.processing_level != 'RAW':\n    print(f'Geometry data keys: {ms_reader.geom_ls.keys()}')\nprint(f'Frames data keys: {ms_reader.frames.keys()}')\nprint(f'Wavelengths data keys: {ms_reader.wavelengths.keys()}')\nprint(f'MERTIS TIS metadata keys: {ms_reader.mertis_tis_metadata.keys()}')\nprint(f'Space index merged shape: {ms_reader.space_index_merged.shape}')\nprint(f'BB7 index merged shape: {ms_reader.bb7_index_merged.shape}')\nprint(f'BB3 index merged shape: {ms_reader.bb3_index_merged.shape}')\nprint(f'Planet index merged shape: {ms_reader.planet_index_merged.shape}')\n\nGeometry data keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nFrames data keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nWavelengths data keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nMERTIS TIS metadata keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nSpace index merged shape: (21,)\nBB7 index merged shape: (0,)\nBB3 index merged shape: (0,)\nPlanet index merged shape: (0,)\n\n\nA data directory can contains more file for each type, those are collected in a dict for each ms_reader variable , so it is handy to define which file we want to work with after inspection, like the following :\n\nfile_key = list(ms_reader.frames.keys())[0]\nprint(f'Example DataCube shape for file {file_key}: {ms_reader.frames[file_key].shape}')\n\nExample DataCube shape for file mer_cal_sc_tis_20200409_1-0651130819-21186__0_1: (40, 100, 21)\n\n\n\n\n\nnow, let’s see some (meta)data:\n\nms_reader.mertis_tis_metadata[file_key].iloc[0:4].T\n\n\n\n\n\n\n\n\n0\n1\n2\n3\n\n\n\n\nTIME_UTC\n2020-04-09T05:40:20.710Z\n2020-04-09T05:40:31.748Z\n2020-04-09T05:40:32.548Z\n2020-04-09T05:40:33.348Z\n\n\nTIME_OBT\n1/0651130819:21186\n1/0651130830:23689\n1/0651130831:10567\n1/0651130831:62998\n\n\nTimeStamp\n651130823.044403\n651130830.950928\n651130831.746674\n651130832.544235\n\n\nHK_STAT_TIS_DATA_ACQ_ID\n3740\n3743\n3744\n3745\n\n\nHK_STAT_TIS_DATA_ACQ_TYPE\nSci_Raw\nSci_Subtracted_BB3\nSci_Subtracted_BB3\nSci_Subtracted_BB3\n\n\nHK_STAT_TIS_DATA_ACQ_TARGET\nSpace\nSpace\nSpace\nSpace\n\n\nHK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET\n2\n2\n2\n2\n\n\nHK_STAT_TIS_DATA_ACQ_TIME\n651130819.323273\n651130830.361465\n651130831.16124\n651130831.961273\n\n\nPAR_TIS_BIN_MODE\n1x2\n1x2\n1x2\n1x2\n\n\nPAR_TIS_WIN_SIZE\n100x80pixel\n100x80pixel\n100x80pixel\n100x80pixel\n\n\nPAR_TIS_COMP_MODE\nlossless\nlossless\nlossless\nlossless\n\n\nHK_STAT_TIS_COMP_VERSION\n1\n1\n1\n1\n\n\nHK_STAT_TIS_COMP_RICE_K_VALUE\n8\n8\n8\n8\n\n\nHK_STAT_TIS_COMP_INPUT_LENGTH\n100\n100\n100\n100\n\n\nHK_STAT_TIS_COMP_NUM_BANDS\n5\n5\n5\n5\n\n\nHK_STAT_TIS_NUM_OVERSAMP\n0\n32\n32\n32\n\n\nHK_TEMP_BOL_CHIP\n15.0\n15.0\n15.003\n15.002\n\n\nDAT_TIS_OFFSET_MACRO_PIXEL\n1\n2052\n2052\n2053\n\n\nHK_TEMP_BOL_HOUSING\n9.527\n9.519\n9.519\n9.52\n\n\nHK_TEMP_OST_BASE_PLATE\n9.894\n9.891\n9.889\n9.889\n\n\nPAR_TIS_DATA_NOISE_REDUCTION\n0\n0\n0\n0\n\n\nHK_STAT_TIS_TOTAL_PACKET_NUM\n1\n1\n1\n1\n\n\nHK_STAT_TIS_CURRENT_PACKET_NUM\n1\n1\n1\n1\n\n\nHK_STAT_TIS_NUM_DATA_WORDS\n384\n1206\n1200\n1208\n\n\n\n\n\n\n\n\nfrom matplotlib import pyplot as plt\nimport matplotlib.dates as mdates\n\nax = ms_reader.mertis_tis_metadata[file_key]\\\n    .set_index('TIME_UTC').loc[:,'HK_STAT_TIS_COMP_VERSION':]\\\n        .plot(figsize=[10,15], legend=True, title='MERTIS TIS Metadata', grid=True, subplots=True);\n\nax[-1].xaxis.set_major_formatter(mdates.DateFormatter('%H:%M:%S'))\nax[-1].set_xlabel('TIME_UTC', fontsize=10)\nplt.tight_layout()\n\nplt.tight_layout()\n\n\n\n\n\n\n\n\nNow some data from TIS detector, each one a 2D array.\nFor those data, dufing cruise, the scientific data are collected ueing the Space port and not Planet port.\nTIS Datacube size is the union of several TIS 2D array measurement, each one typically (40, 100) = (n_spectral,n_spatial), depending on binning and windowing.\n\nms_reader.frames[file_key].shape\n\n(40, 100, 21)\n\n\n(40, 100, 21) = (n_spectral,n_spatial,n_frames)\n\nn_spectral : number of spectral channels, depends on pixel spectral binning (1,2,4) result in n_spatial == (80,40,20)\nn_spatial : number of measurements spatial pixels, depends on pixel spatial binning (1,2,4) result in n_spatial == (100,50,25)\nn_frames : number of TIS frames, or measurements, this correspond to the time axis.\n\n\nfull_frames_3D = ms_reader.frames[file_key]\nwav = ms_reader.wavelengths[file_key]\nplot_index = ms_reader.space_index[file_key]\nprint(f'plot_index: {plot_index}')\n\nfig, ax = plt.subplots(ncols=2,nrows=2, figsize = [22,12])\n\nfig.suptitle(f'MERTIS TIS DataCube - {file_key} \\n'\n             f'average over the measurements {full_frames_3D.shape} -&gt; {full_frames_3D[:,:,0].shape}',\n             fontsize=16)\ntitle = 'Space'\nax[0][0].plot(wav,full_frames_3D[:,:,plot_index].mean(axis=2));\nax[0][0].set_title(f'{title} - frames average ')\nax[0][1].imshow(full_frames_3D[:,:,plot_index].mean(axis=2),aspect='auto',cmap=plt.cm.Spectral_r)\nax[0][1].set_title(f'{title} - frames average')\n\nax[1][0].set_title(f'{title} - frames std')\nax[1][0].plot(wav,full_frames_3D[:,:,plot_index].std(axis=2));\nax[1][1].set_title(f'{title} - frames std')\nax[1][1].imshow(full_frames_3D[:,:,plot_index].std(axis=2),aspect='auto',cmap=plt.cm.Spectral_r)\n\n_ = [a.set_xlabel('Wavelength [nm]') for a in ax[:,0]]\n_ = [a.set_ylabel('Radiance [W/m2/sr/nm]') for a in ax[:,0]]\n_ = [a.grid(True) for a in ax[:,0]]\n\n_ = [a.set_xlabel('Frame Index') for a in ax[:,1]]\n_ = [a.set_ylabel('Wavelength Index') for a in ax[:,1]]\n\nplt.tight_layout()\n\nplot_index: RangeIndex(start=0, stop=21, step=1)\n\n\n\n\n\n\n\n\n\n\nplt.imshow(full_frames_3D[-1,:,plot_index].T,aspect='auto',cmap=plt.cm.Spectral_r)\n\nplt.xlabel('Fame Index')\nplt.ylabel('TIS Spatial Pixel Index')\n\nText(0, 0.5, 'TIS Spatial Pixel Index')\n\n\n\n\n\n\n\n\n\nThe higher level pixel near 40 are the “first light” MERTIS ever saw in space, from the Moon.\nNow some geometry data , not available in RAW data.\n\nrich.print(ms_reader.geom_ls[file_key].keys())\n\ndict_keys(['MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE', 'MERTIS_TIS_GEOMETRY_TARGET_LATITUDE', \n'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LONGITUDE', 'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LATITUDE', \n'MERTIS_TIS_GEOMETRY_SUB_SUN_LONGITUDE', 'MERTIS_TIS_GEOMETRY_SUB_SUN_LATITUDE', \n'MERTIS_TIS_GEOMETRY_TARGET_ALTITUDE', 'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_ALTITUDE', \n'MERTIS_TIS_GEOMETRY_SUB_SUN_ALTITUDE', 'MERTIS_TIS_GEOMETRY_TARGET_DISTANCE', \n'MERTIS_TIS_GEOMETRY_TARGET_ANGULAR_DIAMETER', 'MERTIS_TIS_GEOMETRY_LOCAL_TIME', \n'MERTIS_TIS_GEOMETRY_TARGET_PHASE_ANGLE', 'MERTIS_TIS_GEOMETRY_TARGET_EMISSION_ANGLE', \n'MERTIS_TIS_GEOMETRY_TARGET_INCIDENCE_ANGLE'])\n\n\n\n\nms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE'].shape\n\n(5, 100, 21)\n\n\nThe dimension for the geoemtry variables are (5, 100, 21) == (corners, n_spatial, n_frames) :\n\nCorners of each pixel used for SPICE calculation, in order, looking from instrument , X axis up = (center, upper left, upper right, lower right, lower left)\n\nC2       C1\n +-------+\n |       |\n |  C0   |\n |       |\n +-------+\nC3      C4\n\nn_spatial : number of measurements spatial pixels, depends on pixel spatial binning (1,2,4) result in n_spatial == (100,50,25)\nn_frames : number of TIS frames, or measurements, this correspond to the time axis in the TIS datacube.\n\n\nplt.figure(figsize=(16, 6))\nlongitudes = ms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE']\nlongitudes_center = longitudes[0,:,:]\nlatitudes = ms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_TARGET_LATITUDE']\nlatitudes_center = latitudes[0,:,:]\n\nlocal_times = ms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_LOCAL_TIME']\nlocal_times_center = local_times[0,:,:]\n\nsc = plt.scatter(longitudes_center.flatten(), latitudes_center.flatten(), c=local_times_center.flatten(), s=10, cmap='Spectral_r')\nplt.xlabel('Longitude')\ncbar = plt.colorbar(sc)\ncbar.set_label('Local Time')\nplt.ylabel('Latitudes')\nplt.title('Scatter plot of Target Longitude vs Latitude centers')\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nLet’s find some TIS sptail pixels with defined geometries on all corners\n\nimport numpy as np\n\narr = latitudes  # shape (5, 100, 21)\nnot_nan_mask = ~np.isnan(arr)\nall_not_nan = np.all(not_nan_mask, axis=0)  # shape (100, 21)\nindices = np.argwhere(all_not_nan)  # returns (i, j) pairs where all axis=0 are not nan\n\nprint(len(indices))\nprint(indices[:5])\n\n105\n[[38  0]\n [38  1]\n [38  2]\n [38  3]\n [38  4]]\n\n\n\nplt.figure(figsize=(8, 6))\n\npixel_index = indices[0]  # Take the first valid pixel for demonstration\n\n# Plot the corners of the polygon\nplt.scatter(longitudes[1:,pixel_index[0],pixel_index[1] ], latitudes[1:,pixel_index[0],pixel_index[1] ], s=100, c='black')\n\n# Extract the longitude and latitude for the corners (1:5), close the polygon by repeating the first corner\npoly_lons = longitudes[1:, pixel_index[0], pixel_index[1]]\npoly_lats = latitudes[1:, pixel_index[0], pixel_index[1]]\n# Close the polygon\npoly_lons = np.append(poly_lons, poly_lons[0])\npoly_lats = np.append(poly_lats, poly_lats[0])\n\nfor i in range(1, 5):\n    plt.text(\n        poly_lons[i-1],\n        poly_lats[i-1]+0.5,  # Offset the text slightly above the point\n        f'Corner_{i}',\n        fontsize=10,\n        color='black',\n        ha='left',\n        va='bottom'\n    )\n\n# Plot the connecting lines\nplt.plot(poly_lons, poly_lats, linestyle='-', color='black')\n\nplt.scatter(longitudes[0,pixel_index[0],pixel_index[1] ], latitudes[0,pixel_index[0],pixel_index[1] ], s=100)\nplt.text(\n    longitudes[0, pixel_index[0], pixel_index[1]],\n    latitudes[0, pixel_index[0], pixel_index[1]]+0.5,  # Offset the text slightly above the point\n    'Center',\n    fontsize=12,\n    color='blue',\n    ha='left',\n    va='bottom'\n)\n\nText(31.43904149826383, -33.20697106068339, 'Center')"
  },
  {
    "objectID": "index.html#mertisreader---quick-cheatsheet",
    "href": "index.html#mertisreader---quick-cheatsheet",
    "title": "install",
    "section": "",
    "text": "Import Required Libraries\n\nimport pathlib\nimport rich\nimport mertisreader as mr\n\nprint(\"Libraries imported successfully.\")\n\nLibraries imported successfully.\n\n\n\n\nInitialize the MERTISSessionReader with the input directory and optional parameters for output directory and log level.\nThe ../data/ contains a subset of the Moon flyby , technically called Earth Gravity Assist (EGA).\nThe directory name reflects ESA-PSA/PDS4 naminhc scheme and the start / stop data acquistion , plus the data pack creation.\nUnder this, there the different data levels :\n\n\n\n\n\n\n\n\n\n\nLevel\nUnits\nGeometry\nCalibration Targets\nTIS Aligned\n\n\n\n\nraw\nDigital Numbers\nNo\nNo\nNo\n\n\npar\nPhysical Units\nYes\nYes\nNo\n\n\ncal\nPhysical Units\nYes\nNo\nYes\n\n\n\n\nCalibration Target : if the currnet level contains calibration target measurements or only scientifically relevant one.\nTIS Aligned: : the TIS (Thermal Infrared Spectrometer) wavelength grid is aligned with the detector’s X and Y axes, so all pixels share the same wavelength grid. If not aligned, each pixel has its own wavelength grid, making data comparison and analysis more complex.\n\nJust change the level directory, the package can handle all the levels and read the data, take care of not calling geometry related paramter on RAW.\n\ninput_path = pathlib.Path('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal')\noutput_path = pathlib.Path('/tmp/')\nlog_level = 'INFO'\n\nif not input_path.exists():\n    print(f\"Input path {input_path} does not exist.\")\nelse:\n    print(f\"Reading path {input_path}\")\n\nms_reader = mr.MERTISDataPackReader(input_dir=input_path, output_dir=output_path, log_level=log_level)\n\nprint(f'MERTISDataPackReader initialized with input directory: {ms_reader.input_dir}')\nprint(f'Output directory: {ms_reader.output_dir}')\nprint(f'Log level: {ms_reader.log_level}')\n\n2025-10-02 16:44:54,927|452487|INFO|input_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal')\n\n\nReading path ../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal\nMERTISDataPackReader initialized with input directory: ../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal\nOutput directory: /tmp\nLog level: INFO\n\n\nShow Files in Input Directory\n\nms_reader.show_files()\n\nAll files in input_dir :\n\n\nCounter({'.dat': 2, '.lblx': 3, '.fits': 1})\n\n\n\nAll files in input_dir matching old pattern &lt;v0.2.6 (\\d{8}_\\d{8}):\n\n\nCounter()\n\n\n\nAll files in input_dir matching new pattern &gt;=v0.2.6 (mer_cal_sc_tis_YYYYMMDD_1-...):\n\n\nCounter({'mer_cal_sc_tis': 1})\n\n\n\nList File Types\n\nms_reader.listfiletypes()\n\n{\n    'hk_default': ['mer_cal_hk_default_20200409_1-0651130766-12538__0_1.dat'],\n    'hk_extended': ['mer_cal_hk_extended_20200409_1-0651130766-12595__0_1.dat'],\n    'sc_tis': ['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1.fits'],\n    'sc_tir': [],\n    'sc_tis_ql': [],\n    'sc_tir_ql': []\n}\n\n\n\n{'hk_default': 1, 'hk_extended': 1, 'sc_tis': 1, 'sc_tir': 0, 'sc_tis_ql': 0, 'sc_tir_ql': 0}\n\n\n\nCollect Data\n\nms_reader.data_collector()\n\nprint(f'Collected data keys: {ms_reader.collect_data.keys()}')\nfor key, value in ms_reader.collect_data.items():\n    print(f'{key}: {len(value)} files collected')\n\nReading filetype: hk_default from mer_cal_hk_default_20200409_1-0651130766-12538__0_1\nReading filetype: hk_extended from mer_cal_hk_extended_20200409_1-0651130766-12595__0_1\nReading filetype: tis from mer_cal_sc_tis_20200409_1-0651130819-21186__0_1\nCollected data keys: dict_keys(['hk_default', 'hk_extended', 'tis'])\nhk_default: 1 files collected\nhk_extended: 1 files collected\ntis: 1 files collected\n\n\nAssemble Data\n\nms_reader.data_assembler(verbose=True)\n\n\n\n\nReading filetype: tis from \n../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal/me\nr_cal_sc_tis_20200409_1-0651130819-21186__0_1.fits\n\n\n\n\n\n\nn_wav=40 # generic wavelengths : not precise enough for scientific analysis!\n|    | tis_stem                                        |   finite(geo) |   geo.size |\n|---:|:------------------------------------------------|--------------:|-----------:|\n|  0 | mer_cal_sc_tis_20200409_1-0651130819-21186__0_1 |           672 |      10500 |\nIndices of measurements targets (HK_STAT_TIS_DATA_ACQ_TARGET):\nspace_index_merged.shape=(21,)\nbb7_index_merged.shape=(0,)\nbb3_index_merged.shape=(0,)\nplanet_index_merged.shape=(0,)\nCollected data statistics:\nNumber of TIS files: 1\nNumber of HK files: 2\nNumber of TIR files: 0\nNumber of TIS QL files: 0\nNumber of TIR QL files: 0\n\n\nVerify the Assembled Data\n\n# RAW does not have geometry data\nif ms_reader.processing_level != 'RAW':\n    print(f'Geometry data keys: {ms_reader.geom_ls.keys()}')\nprint(f'Frames data keys: {ms_reader.frames.keys()}')\nprint(f'Wavelengths data keys: {ms_reader.wavelengths.keys()}')\nprint(f'MERTIS TIS metadata keys: {ms_reader.mertis_tis_metadata.keys()}')\nprint(f'Space index merged shape: {ms_reader.space_index_merged.shape}')\nprint(f'BB7 index merged shape: {ms_reader.bb7_index_merged.shape}')\nprint(f'BB3 index merged shape: {ms_reader.bb3_index_merged.shape}')\nprint(f'Planet index merged shape: {ms_reader.planet_index_merged.shape}')\n\nGeometry data keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nFrames data keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nWavelengths data keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nMERTIS TIS metadata keys: dict_keys(['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1'])\nSpace index merged shape: (21,)\nBB7 index merged shape: (0,)\nBB3 index merged shape: (0,)\nPlanet index merged shape: (0,)\n\n\nA data directory can contains more file for each type, those are collected in a dict for each ms_reader variable , so it is handy to define which file we want to work with after inspection, like the following :\n\nfile_key = list(ms_reader.frames.keys())[0]\nprint(f'Example DataCube shape for file {file_key}: {ms_reader.frames[file_key].shape}')\n\nExample DataCube shape for file mer_cal_sc_tis_20200409_1-0651130819-21186__0_1: (40, 100, 21)\n\n\n\n\n\nnow, let’s see some (meta)data:\n\nms_reader.mertis_tis_metadata[file_key].iloc[0:4].T\n\n\n\n\n\n\n\n\n0\n1\n2\n3\n\n\n\n\nTIME_UTC\n2020-04-09T05:40:20.710Z\n2020-04-09T05:40:31.748Z\n2020-04-09T05:40:32.548Z\n2020-04-09T05:40:33.348Z\n\n\nTIME_OBT\n1/0651130819:21186\n1/0651130830:23689\n1/0651130831:10567\n1/0651130831:62998\n\n\nTimeStamp\n651130823.044403\n651130830.950928\n651130831.746674\n651130832.544235\n\n\nHK_STAT_TIS_DATA_ACQ_ID\n3740\n3743\n3744\n3745\n\n\nHK_STAT_TIS_DATA_ACQ_TYPE\nSci_Raw\nSci_Subtracted_BB3\nSci_Subtracted_BB3\nSci_Subtracted_BB3\n\n\nHK_STAT_TIS_DATA_ACQ_TARGET\nSpace\nSpace\nSpace\nSpace\n\n\nHK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET\n2\n2\n2\n2\n\n\nHK_STAT_TIS_DATA_ACQ_TIME\n651130819.323273\n651130830.361465\n651130831.16124\n651130831.961273\n\n\nPAR_TIS_BIN_MODE\n1x2\n1x2\n1x2\n1x2\n\n\nPAR_TIS_WIN_SIZE\n100x80pixel\n100x80pixel\n100x80pixel\n100x80pixel\n\n\nPAR_TIS_COMP_MODE\nlossless\nlossless\nlossless\nlossless\n\n\nHK_STAT_TIS_COMP_VERSION\n1\n1\n1\n1\n\n\nHK_STAT_TIS_COMP_RICE_K_VALUE\n8\n8\n8\n8\n\n\nHK_STAT_TIS_COMP_INPUT_LENGTH\n100\n100\n100\n100\n\n\nHK_STAT_TIS_COMP_NUM_BANDS\n5\n5\n5\n5\n\n\nHK_STAT_TIS_NUM_OVERSAMP\n0\n32\n32\n32\n\n\nHK_TEMP_BOL_CHIP\n15.0\n15.0\n15.003\n15.002\n\n\nDAT_TIS_OFFSET_MACRO_PIXEL\n1\n2052\n2052\n2053\n\n\nHK_TEMP_BOL_HOUSING\n9.527\n9.519\n9.519\n9.52\n\n\nHK_TEMP_OST_BASE_PLATE\n9.894\n9.891\n9.889\n9.889\n\n\nPAR_TIS_DATA_NOISE_REDUCTION\n0\n0\n0\n0\n\n\nHK_STAT_TIS_TOTAL_PACKET_NUM\n1\n1\n1\n1\n\n\nHK_STAT_TIS_CURRENT_PACKET_NUM\n1\n1\n1\n1\n\n\nHK_STAT_TIS_NUM_DATA_WORDS\n384\n1206\n1200\n1208\n\n\n\n\n\n\n\n\nfrom matplotlib import pyplot as plt\nimport matplotlib.dates as mdates\n\nax = ms_reader.mertis_tis_metadata[file_key]\\\n    .set_index('TIME_UTC').loc[:,'HK_STAT_TIS_COMP_VERSION':]\\\n        .plot(figsize=[10,15], legend=True, title='MERTIS TIS Metadata', grid=True, subplots=True);\n\nax[-1].xaxis.set_major_formatter(mdates.DateFormatter('%H:%M:%S'))\nax[-1].set_xlabel('TIME_UTC', fontsize=10)\nplt.tight_layout()\n\nplt.tight_layout()\n\n\n\n\n\n\n\n\nNow some data from TIS detector, each one a 2D array.\nFor those data, dufing cruise, the scientific data are collected ueing the Space port and not Planet port.\nTIS Datacube size is the union of several TIS 2D array measurement, each one typically (40, 100) = (n_spectral,n_spatial), depending on binning and windowing.\n\nms_reader.frames[file_key].shape\n\n(40, 100, 21)\n\n\n(40, 100, 21) = (n_spectral,n_spatial,n_frames)\n\nn_spectral : number of spectral channels, depends on pixel spectral binning (1,2,4) result in n_spatial == (80,40,20)\nn_spatial : number of measurements spatial pixels, depends on pixel spatial binning (1,2,4) result in n_spatial == (100,50,25)\nn_frames : number of TIS frames, or measurements, this correspond to the time axis.\n\n\nfull_frames_3D = ms_reader.frames[file_key]\nwav = ms_reader.wavelengths[file_key]\nplot_index = ms_reader.space_index[file_key]\nprint(f'plot_index: {plot_index}')\n\nfig, ax = plt.subplots(ncols=2,nrows=2, figsize = [22,12])\n\nfig.suptitle(f'MERTIS TIS DataCube - {file_key} \\n'\n             f'average over the measurements {full_frames_3D.shape} -&gt; {full_frames_3D[:,:,0].shape}',\n             fontsize=16)\ntitle = 'Space'\nax[0][0].plot(wav,full_frames_3D[:,:,plot_index].mean(axis=2));\nax[0][0].set_title(f'{title} - frames average ')\nax[0][1].imshow(full_frames_3D[:,:,plot_index].mean(axis=2),aspect='auto',cmap=plt.cm.Spectral_r)\nax[0][1].set_title(f'{title} - frames average')\n\nax[1][0].set_title(f'{title} - frames std')\nax[1][0].plot(wav,full_frames_3D[:,:,plot_index].std(axis=2));\nax[1][1].set_title(f'{title} - frames std')\nax[1][1].imshow(full_frames_3D[:,:,plot_index].std(axis=2),aspect='auto',cmap=plt.cm.Spectral_r)\n\n_ = [a.set_xlabel('Wavelength [nm]') for a in ax[:,0]]\n_ = [a.set_ylabel('Radiance [W/m2/sr/nm]') for a in ax[:,0]]\n_ = [a.grid(True) for a in ax[:,0]]\n\n_ = [a.set_xlabel('Frame Index') for a in ax[:,1]]\n_ = [a.set_ylabel('Wavelength Index') for a in ax[:,1]]\n\nplt.tight_layout()\n\nplot_index: RangeIndex(start=0, stop=21, step=1)\n\n\n\n\n\n\n\n\n\n\nplt.imshow(full_frames_3D[-1,:,plot_index].T,aspect='auto',cmap=plt.cm.Spectral_r)\n\nplt.xlabel('Fame Index')\nplt.ylabel('TIS Spatial Pixel Index')\n\nText(0, 0.5, 'TIS Spatial Pixel Index')\n\n\n\n\n\n\n\n\n\nThe higher level pixel near 40 are the “first light” MERTIS ever saw in space, from the Moon.\nNow some geometry data , not available in RAW data.\n\nrich.print(ms_reader.geom_ls[file_key].keys())\n\ndict_keys(['MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE', 'MERTIS_TIS_GEOMETRY_TARGET_LATITUDE', \n'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LONGITUDE', 'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LATITUDE', \n'MERTIS_TIS_GEOMETRY_SUB_SUN_LONGITUDE', 'MERTIS_TIS_GEOMETRY_SUB_SUN_LATITUDE', \n'MERTIS_TIS_GEOMETRY_TARGET_ALTITUDE', 'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_ALTITUDE', \n'MERTIS_TIS_GEOMETRY_SUB_SUN_ALTITUDE', 'MERTIS_TIS_GEOMETRY_TARGET_DISTANCE', \n'MERTIS_TIS_GEOMETRY_TARGET_ANGULAR_DIAMETER', 'MERTIS_TIS_GEOMETRY_LOCAL_TIME', \n'MERTIS_TIS_GEOMETRY_TARGET_PHASE_ANGLE', 'MERTIS_TIS_GEOMETRY_TARGET_EMISSION_ANGLE', \n'MERTIS_TIS_GEOMETRY_TARGET_INCIDENCE_ANGLE'])\n\n\n\n\nms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE'].shape\n\n(5, 100, 21)\n\n\nThe dimension for the geoemtry variables are (5, 100, 21) == (corners, n_spatial, n_frames) :\n\nCorners of each pixel used for SPICE calculation, in order, looking from instrument , X axis up = (center, upper left, upper right, lower right, lower left)\n\nC2       C1\n +-------+\n |       |\n |  C0   |\n |       |\n +-------+\nC3      C4\n\nn_spatial : number of measurements spatial pixels, depends on pixel spatial binning (1,2,4) result in n_spatial == (100,50,25)\nn_frames : number of TIS frames, or measurements, this correspond to the time axis in the TIS datacube.\n\n\nplt.figure(figsize=(16, 6))\nlongitudes = ms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE']\nlongitudes_center = longitudes[0,:,:]\nlatitudes = ms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_TARGET_LATITUDE']\nlatitudes_center = latitudes[0,:,:]\n\nlocal_times = ms_reader.geom_ls[file_key]['MERTIS_TIS_GEOMETRY_LOCAL_TIME']\nlocal_times_center = local_times[0,:,:]\n\nsc = plt.scatter(longitudes_center.flatten(), latitudes_center.flatten(), c=local_times_center.flatten(), s=10, cmap='Spectral_r')\nplt.xlabel('Longitude')\ncbar = plt.colorbar(sc)\ncbar.set_label('Local Time')\nplt.ylabel('Latitudes')\nplt.title('Scatter plot of Target Longitude vs Latitude centers')\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nLet’s find some TIS sptail pixels with defined geometries on all corners\n\nimport numpy as np\n\narr = latitudes  # shape (5, 100, 21)\nnot_nan_mask = ~np.isnan(arr)\nall_not_nan = np.all(not_nan_mask, axis=0)  # shape (100, 21)\nindices = np.argwhere(all_not_nan)  # returns (i, j) pairs where all axis=0 are not nan\n\nprint(len(indices))\nprint(indices[:5])\n\n105\n[[38  0]\n [38  1]\n [38  2]\n [38  3]\n [38  4]]\n\n\n\nplt.figure(figsize=(8, 6))\n\npixel_index = indices[0]  # Take the first valid pixel for demonstration\n\n# Plot the corners of the polygon\nplt.scatter(longitudes[1:,pixel_index[0],pixel_index[1] ], latitudes[1:,pixel_index[0],pixel_index[1] ], s=100, c='black')\n\n# Extract the longitude and latitude for the corners (1:5), close the polygon by repeating the first corner\npoly_lons = longitudes[1:, pixel_index[0], pixel_index[1]]\npoly_lats = latitudes[1:, pixel_index[0], pixel_index[1]]\n# Close the polygon\npoly_lons = np.append(poly_lons, poly_lons[0])\npoly_lats = np.append(poly_lats, poly_lats[0])\n\nfor i in range(1, 5):\n    plt.text(\n        poly_lons[i-1],\n        poly_lats[i-1]+0.5,  # Offset the text slightly above the point\n        f'Corner_{i}',\n        fontsize=10,\n        color='black',\n        ha='left',\n        va='bottom'\n    )\n\n# Plot the connecting lines\nplt.plot(poly_lons, poly_lats, linestyle='-', color='black')\n\nplt.scatter(longitudes[0,pixel_index[0],pixel_index[1] ], latitudes[0,pixel_index[0],pixel_index[1] ], s=100)\nplt.text(\n    longitudes[0, pixel_index[0], pixel_index[1]],\n    latitudes[0, pixel_index[0], pixel_index[1]]+0.5,  # Offset the text slightly above the point\n    'Center',\n    fontsize=12,\n    color='blue',\n    ha='left',\n    va='bottom'\n)\n\nText(31.43904149826383, -33.20697106068339, 'Center')"
  },
  {
    "objectID": "core.html",
    "href": "core.html",
    "title": "mertisreader",
    "section": "",
    "text": "2025-10-02T16:50:06.218|INFO|configuration|MainThread:52|Standard configuration file conf/configuration.json found - loading"
  },
  {
    "objectID": "core.html#read-the-data",
    "href": "core.html#read-the-data",
    "title": "mertisreader",
    "section": "Read the data",
    "text": "Read the data\n\nRAW\n\ninput_path = pathlib.Path('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/raw')\nif input_path.exists() :\n    print(f'{input_path=} exists')\nelse :\n    raise FileNotFoundError(f'{input_path=} does not exist')\n# list(input_path.glob('**/*tis*.fits'))\nms = MERTISDataPackReader(input_path,log_level='ERROR')\nrich.print(ms)\n\ninput_path=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/raw') exists\n\n\nMERTISDataPackReader(\n  input_dir=../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-\nshort/raw\n  output_dir=../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK\n-short/raw-analysis_products\n  log_level=ERROR\n  file counts: {\n    hk_default: 1\n    hk_extended: 1\n    sc_tis: 1\n    sc_tir: 0\n    sc_tis_ql: 0\n    sc_tir_ql: 0\n  }\n)\n\n\n\n\nlogging.getLevelName(ms.log.level)\n\n'ERROR'\n\n\n\nms.show_files()\n\nAll files in input_dir :\n\n\nCounter({'.fits': 2, '.lblx': 4, '.dat': 2})\n\n\n\nAll files in input_dir matching old pattern &lt;v0.2.6 (\\d{8}_\\d{8}):\n\n\nCounter()\n\n\n\nAll files in input_dir matching new pattern &gt;=v0.2.6 (mer_cal_sc_tis_YYYYMMDD_1-...):\n\n\nCounter()\n\n\n\n\nms.listfiletypes()\n\n{\n    'hk_default': ['mer_raw_hk_default_20200409_1-0651130766-12538__0_1.dat'],\n    'hk_extended': ['mer_raw_hk_extended_20200409_1-0651130766-12595__0_1.dat'],\n    'sc_tis': ['mer_raw_sc_tis_20200409_1-0651130819-21186__0_1.fits'],\n    'sc_tir': [],\n    'sc_tis_ql': [],\n    'sc_tir_ql': []\n}\n\n\n\n{'hk_default': 1, 'hk_extended': 1, 'sc_tis': 1, 'sc_tir': 0, 'sc_tis_ql': 0, 'sc_tir_ql': 0}\n\n\n\n\n# Collect Data\nms.data_collector()\n\nReading filetype: hk_default from mer_raw_hk_default_20200409_1-0651130766-12538__0_1\nReading filetype: hk_extended from mer_raw_hk_extended_20200409_1-0651130766-12595__0_1\nReading filetype: tis from mer_raw_sc_tis_20200409_1-0651130819-21186__0_1\n\n\n\n# Verify the collected data\nprint(f'Collected data keys: {ms.collect_data.keys()}')\nfor key, value in ms.collect_data.items():\n    print(f'{key}: {len(value)} files collected')\n\nCollected data keys: dict_keys(['hk_default', 'hk_extended', 'tis'])\nhk_default: 1 files collected\nhk_extended: 1 files collected\ntis: 1 files collected\n\n\n\nms.data_assembler()\n\n\n\n\nReading filetype: tis from \n../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/raw/me\nr_raw_sc_tis_20200409_1-0651130819-21186__0_1.fits\n\n\n\n\n\n\n\nrich.inspect(ms,methods=1)\n\n╭──────────────────────────────────── &lt;class '__main__.MERTISDataPackReader'&gt; ────────────────────────────────────╮\n│ Class to read and process MERTIS data.                                                                          │\n│                                                                                                                 │\n│ ╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────╮ │\n│ │ &lt;MERTISDataPackReader(input_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_C │ │\n│ │ RE-20240717T132010-ParamEventBootSciHK-short/raw'),                                                         │ │\n│ │ output_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-Pa │ │\n│ │ ramEventBootSciHK-short/raw-analysis_products'), log_level='ERROR')&gt;                                        │ │\n│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │\n│                                                                                                                 │\n│               bb3_index = {'mer_raw_sc_tis_20200409_1-0651130819-21186__0_1': Index([1], dtype='int64')}        │\n│        bb3_index_merged = Index([1], dtype='int64')                                                             │\n│               bb7_index = {'mer_raw_sc_tis_20200409_1-0651130819-21186__0_1': Index([], dtype='int64')}         │\n│        bb7_index_merged = Index([], dtype='int64')                                                              │\n│            collect_data = {                                                                                     │\n│                               'hk_default': [                                                                   │\n│                                   {                                                                             │\n│                                       'data':                    TIME_UTC            TIME_OBT     TimeStamp     │\n│                           HK_STAT_SID  \\                                                                        │\n│                           0  2020-04-09T05:39:27.578Z  1/0651130766:12538  6.511308e+08            1            │\n│                           1  2020-04-09T05:39:51.858Z  1/0651130790:30939  6.511308e+08            1            │\n│                           2  2020-04-09T05:40:16.050Z  1/0651130814:43482  6.511308e+08            1            │\n│                           3  2020-04-09T05:40:40.327Z  1/0651130838:61650  6.511308e+08            1            │\n│                           4  2020-04-09T05:41:04.522Z  1/0651130863:08879  6.511309e+08            1            │\n│                           5  2020-04-09T05:41:28.796Z  1/0651130887:26854  6.511309e+08            1            │\n│                           6  2020-04-09T05:41:52.987Z  1/0651130911:39353  6.511309e+08            1            │\n│                                                                                                                 │\n│                              PAD  HK_STAT_MERTIS_MODE  FixVal5  HK_STAT_EEPROM_POWER  HK_STAT_EPA_POWER  \\      │\n│                           0    0                   14        0                     0                  0         │\n│                           1    0                   14        0                     0                  0         │\n│                           2    0                   14        0                     0                  0         │\n│                           3    0                   14        0                     0                  0         │\n│                           4    0                   14        0                     0                  0         │\n│                           5    0                   14        0                     0                  0         │\n│                           6    0                   14        0                     0                  0         │\n│                                                                                                                 │\n│                              HK_STAT_HK_POWER  ...  HK_TEMP_PSU  HK_STAT_LAST_ERROR_ID  \\                       │\n│                           0                 1  ...        13.28                  42213                          │\n│                           1                 1  ...        13.28                  42213                          │\n│                           2                 1  ...        13.29                  42213                          │\n│                           3                 1  ...        13.30                  42213                          │\n│                           4                 1  ...        13.30                  42213                          │\n│                           5                 1  ...        13.31                  42213                          │\n│                           6                 1  ...        13.31                  42213                          │\n│                                                                                                                 │\n│                              HK_STAT_LAST_ERROR_FREQUENCY  HK_STAT_NUM_TC_RECEIVED  \\                           │\n│                           0                             1                       46                              │\n│                           1                             1                       46                              │\n│                           2                             1                       46                              │\n│                           3                             1                       46                              │\n│                           4                             1                       46                              │\n│                           5                             1                       46                              │\n│                           6                             1                       46                              │\n│                                                                                                                 │\n│                              HK_STAT_NUM_TC_EXECUTED  HK_STAT_NUM_TM_SENT  HK_STAT_ICU_PROC_DUTY_CYCLE  \\       │\n│                           0                       46                 6441                            7          │\n│                           1                       46                 6467                            7          │\n│                           2                       46                 6494                            6          │\n│                           3                       46                 6520                            7          │\n│                           4                       46                 6547                            7          │\n│                           5                       46                 6573                            7          │\n│                           6                       46                 6600                            6          │\n│                                                                                                                 │\n│                              HK_STAT_ICU_NUM_AHB_ERROR  HK_STAT_ICU_NUM_AHB_CORRECTABLE_ERROR  \\                │\n│                           0                          0                                      0                   │\n│                           1                          0                                      0                   │\n│                           2                          0                                      0                   │\n│                           3                          0                                      0                   │\n│                           4                          0                                      0                   │\n│                           5                          0                                      0                   │\n│                           6                          0                                      0                   │\n│                                                                                                                 │\n│                              HK_STAT_HK_NUM_LATCHUP_ERROR                                                       │\n│                           0                             0                                                       │\n│                           1                             0                                                       │\n│                           2                             0                                                       │\n│                           3                             0                                                       │\n│                           4                             0                                                       │\n│                           5                             0                                                       │\n│                           6                             0                                                       │\n│                                                                                                                 │\n│                           [7 rows x 36 columns],                                                                │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ],                                                                                │\n│                               'hk_extended': [                                                                  │\n│                                   {                                                                             │\n│                                       'data':                    TIME_UTC            TIME_OBT     TimeStamp     │\n│                           HK_STAT_SID  \\                                                                        │\n│                           0  2020-04-09T05:39:27.579Z  1/0651130766:12595  6.511308e+08            2            │\n│                           1  2020-04-09T05:39:51.859Z  1/0651130790:30988  6.511308e+08            2            │\n│                           2  2020-04-09T05:40:16.051Z  1/0651130814:43546  6.511308e+08            2            │\n│                           3  2020-04-09T05:40:40.328Z  1/0651130838:61732  6.511308e+08            2            │\n│                           4  2020-04-09T05:41:04.523Z  1/0651130863:08944  6.511309e+08            2            │\n│                           5  2020-04-09T05:41:28.797Z  1/0651130887:26906  6.511309e+08            2            │\n│                           6  2020-04-09T05:41:52.988Z  1/0651130911:39418  6.511309e+08            2            │\n│                                                                                                                 │\n│                              PAD  HK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET  HK_STAT_SH_REF_TEMP_STABLE  \\         │\n│                           0    0                                       2                           1            │\n│                           1    0                                       2                           1            │\n│                           2    0                                       2                           1            │\n│                           3    0                                       2                           1            │\n│                           4    0                                       2                           1            │\n│                           5    0                                       2                           1            │\n│                           6    0                                       2                           1            │\n│                                                                                                                 │\n│                              HK_STAT_TIS_TEC_STABLE  HK_STAT_EPA_STATUS  FixVal12  ...  \\                       │\n│                           0                       1                   0         0  ...                          │\n│                           1                       1                   0         0  ...                          │\n│                           2                       1                   0         0  ...                          │\n│                           3                       1                   0         0  ...                          │\n│                           4                       1                   0         0  ...                          │\n│                           5                       1                   0         0  ...                          │\n│                           6                       1                   0         0  ...                          │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_CREDIT  HK_STAT_NUM_SPW_ERR_ESCAPE  \\                          │\n│                           0                           0                           0                             │\n│                           1                           0                           0                             │\n│                           2                           0                           0                             │\n│                           3                           0                           0                             │\n│                           4                           0                           0                             │\n│                           5                           0                           0                             │\n│                           6                           0                           0                             │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_DISCONNECT  HK_STAT_NUM_SPW_ERR_PARITY  \\                      │\n│                           0                               0                           0                         │\n│                           1                               0                           0                         │\n│                           2                               0                           0                         │\n│                           3                               0                           0                         │\n│                           4                               0                           0                         │\n│                           5                               0                           0                         │\n│                           6                               0                           0                         │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_WRITESYNC  HK_STAT_NUM_SPW_ERR_INVALIDADDRESS  \\               │\n│                           0                              0                                   0                  │\n│                           1                              0                                   0                  │\n│                           2                              0                                   0                  │\n│                           3                              0                                   0                  │\n│                           4                              0                                   0                  │\n│                           5                              0                                   0                  │\n│                           6                              0                                   0                  │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_EOPEEP  HK_STAT_NUM_SPW_ERR_RXAHB  \\                           │\n│                           0                           0                          0                              │\n│                           1                           0                          0                              │\n│                           2                           0                          0                              │\n│                           3                           0                          0                              │\n│                           4                           0                          0                              │\n│                           5                           0                          0                              │\n│                           6                           0                          0                              │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_TXAHB  HK_STAT_NUM_SPW_ERR_TXBLOCKED                           │\n│                           0                          0                              0                           │\n│                           1                          0                              0                           │\n│                           2                          0                              0                           │\n│                           3                          0                              0                           │\n│                           4                          0                              0                           │\n│                           5                          0                              0                           │\n│                           6                          0                              0                           │\n│                                                                                                                 │\n│                           [7 rows x 44 columns],                                                                │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ],                                                                                │\n│                               'tis': [                                                                          │\n│                                   {                                                                             │\n│                                       'fits_data': [&lt;astropy.io.fits.hdu.image.PrimaryHDU object at             │\n│                           0x7fcdc06adb90&gt;, &lt;astropy.io.fits.hdu.table.BinTableHDU object at 0x7fcdbba39510&gt;,    │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba85dd50&gt;],                       │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ]                                                                                 │\n│                           }                                                                                     │\n│              fits_files = [                                                                                     │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                           ]                                                                                     │\n│                  frames = {                                                                                     │\n│                               'mer_raw_sc_tis_20200409_1-0651130819-21186__0_1': array([[[   0.,    0.,    0.,  │\n│                           ...,    0.,    0.,    0.],                                                            │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   ...,                                                                          │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.]],                             │\n│                                                                                                                 │\n│                                  [[2372., 2314., 2292., ..., 2172., 2130., 2123.],                              │\n│                                   [2574., 2508., 2489., ..., 2477., 2466., 2518.],                              │\n│                                   [2346., 2292., 2228., ..., 2164., 2151., 2137.],                              │\n│                                   ...,                                                                          │\n│                                   [1967., 1951., 1868., ..., 2013., 1984., 1978.],                              │\n│                                   [1836., 1682., 1688., ..., 1729., 1789., 1684.],                              │\n│                                   [1777., 1730., 1769., ..., 1778., 1797., 1788.]],                             │\n│                                                                                                                 │\n│                                  [[2355., 2295., 2273., ..., 2148., 2110., 2107.],                              │\n│                                   [2562., 2493., 2471., ..., 2452., 2444., 2503.],                              │\n│                                   [2331., 2276., 2213., ..., 2140., 2131., 2125.],                              │\n│                                   ...,                                                                          │\n│                                   [1951., 1935., 1852., ..., 1990., 1963., 1969.],                              │\n│                                   [1822., 1667., 1670., ..., 1707., 1772., 1678.],                              │\n│                                   [1769., 1720., 1754., ..., 1759., 1782., 1782.]],                             │\n│                                                                                                                 │\n│                                  ...,                                                                           │\n│                                                                                                                 │\n│                                  [[2364., 2307., 2284., ..., 2159., 2117., 2117.],                              │\n│                                   [2570., 2504., 2483., ..., 2466., 2454., 2514.],                              │\n│                                   [2339., 2284., 2222., ..., 2149., 2144., 2134.],                              │\n│                                   ...,                                                                          │\n│                                   [1957., 1943., 1858., ..., 1999., 1972., 1975.],                              │\n│                                   [1829., 1675., 1678., ..., 1714., 1780., 1687.],                              │\n│                                   [1773., 1725., 1761., ..., 1765., 1788., 1791.]],                             │\n│                                                                                                                 │\n│                                  [[2367., 2307., 2288., ..., 2161., 2118., 2118.],                              │\n│                                   [2569., 2505., 2483., ..., 2464., 2454., 2514.],                              │\n│                                   [2341., 2285., 2222., ..., 2151., 2142., 2133.],                              │\n│                                   ...,                                                                          │\n│                                   [1957., 1945., 1860., ..., 1999., 1972., 1976.],                              │\n│                                   [1828., 1676., 1679., ..., 1715., 1781., 1687.],                              │\n│                                   [1778., 1728., 1764., ..., 1770., 1792., 1793.]],                             │\n│                                                                                                                 │\n│                                  [[   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   ...,                                                                          │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.],                              │\n│                                   [   0.,    0.,    0., ...,    0.,    0.,    0.]]],                            │\n│                                 shape=(22, 100, 40))                                                            │\n│                           }                                                                                     │\n│                 geom_ls = {}                                                                                    │\n│               input_dir = PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│         input_path_dict = {                                                                                     │\n│                               'hk_default': [                                                                   │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'hk_extended': [                                                                  │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'sc_tis': [                                                                       │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'sc_tir': [],                                                                     │\n│                               'sc_tis_ql': [],                                                                  │\n│                               'sc_tir_ql': []                                                                   │\n│                           }                                                                                     │\n│                     log = &lt;RootLogger root (ERROR)&gt;                                                             │\n│               log_level = 'ERROR'                                                                               │\n│     mertis_tis_metadata = {                                                                                     │\n│                               'mer_raw_sc_tis_20200409_1-0651130819-21186__0_1':                     TIME_UTC   │\n│                           TIME_OBT     TimeStamp  \\                                                             │\n│                           0   2020-04-09T05:40:20.710Z  1/0651130819:21186  6.511308e+08                        │\n│                           1   2020-04-09T05:40:28.335Z  1/0651130826:62158  6.511308e+08                        │\n│                           2   2020-04-09T05:40:31.748Z  1/0651130830:23689  6.511308e+08                        │\n│                           3   2020-04-09T05:40:32.548Z  1/0651130831:10567  6.511308e+08                        │\n│                           4   2020-04-09T05:40:33.348Z  1/0651130831:62998  6.511308e+08                        │\n│                           5   2020-04-09T05:40:34.148Z  1/0651130832:49891  6.511308e+08                        │\n│                           6   2020-04-09T05:40:34.948Z  1/0651130833:36784  6.511308e+08                        │\n│                           7   2020-04-09T05:40:35.748Z  1/0651130834:23676  6.511308e+08                        │\n│                           8   2020-04-09T05:40:36.548Z  1/0651130835:10569  6.511308e+08                        │\n│                           9   2020-04-09T05:40:37.348Z  1/0651130835:62998  6.511308e+08                        │\n│                           10  2020-04-09T05:40:38.148Z  1/0651130836:49891  6.511308e+08                        │\n│                           11  2020-04-09T05:40:38.948Z  1/0651130837:36783  6.511308e+08                        │\n│                           12  2020-04-09T05:40:39.748Z  1/0651130838:23676  6.511308e+08                        │\n│                           13  2020-04-09T05:40:40.548Z  1/0651130839:10569  6.511308e+08                        │\n│                           14  2020-04-09T05:40:41.348Z  1/0651130839:62998  6.511308e+08                        │\n│                           15  2020-04-09T05:40:42.148Z  1/0651130840:49891  6.511308e+08                        │\n│                           16  2020-04-09T05:40:42.948Z  1/0651130841:36783  6.511308e+08                        │\n│                           17  2020-04-09T05:40:43.748Z  1/0651130842:23676  6.511308e+08                        │\n│                           18  2020-04-09T05:40:44.548Z  1/0651130843:10569  6.511308e+08                        │\n│                           19  2020-04-09T05:40:45.348Z  1/0651130843:62998  6.511308e+08                        │\n│                           20  2020-04-09T05:40:46.148Z  1/0651130844:49891  6.511308e+08                        │\n│                           21  2020-04-09T05:40:46.948Z  1/0651130845:36784  6.511308e+08                        │\n│                                                                                                                 │\n│                               HK_STAT_TIS_DATA_ACQ_ID HK_STAT_TIS_DATA_ACQ_TYPE  \\                              │\n│                           0                      3740                   Sci_Raw                                 │\n│                           1                      3742                   Sci_Raw                                 │\n│                           2                      3743        Sci_Subtracted_BB3                                 │\n│                           3                      3744        Sci_Subtracted_BB3                                 │\n│                           4                      3745        Sci_Subtracted_BB3                                 │\n│                           5                      3746        Sci_Subtracted_BB3                                 │\n│                           6                      3747        Sci_Subtracted_BB3                                 │\n│                           7                      3748        Sci_Subtracted_BB3                                 │\n│                           8                      3749        Sci_Subtracted_BB3                                 │\n│                           9                      3750        Sci_Subtracted_BB3                                 │\n│                           10                     3751        Sci_Subtracted_BB3                                 │\n│                           11                     3752        Sci_Subtracted_BB3                                 │\n│                           12                     3753        Sci_Subtracted_BB3                                 │\n│                           13                     3754        Sci_Subtracted_BB3                                 │\n│                           14                     3755        Sci_Subtracted_BB3                                 │\n│                           15                     3756        Sci_Subtracted_BB3                                 │\n│                           16                     3757        Sci_Subtracted_BB3                                 │\n│                           17                     3758        Sci_Subtracted_BB3                                 │\n│                           18                     3759        Sci_Subtracted_BB3                                 │\n│                           19                     3760        Sci_Subtracted_BB3                                 │\n│                           20                     3761        Sci_Subtracted_BB3                                 │\n│                           21                     3762                   Sci_Raw                                 │\n│                                                                                                                 │\n│                              HK_STAT_TIS_DATA_ACQ_TARGET  HK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET  \\             │\n│                           0                        Space                                       2                │\n│                           1                          BB3                                       2                │\n│                           2                        Space                                       2                │\n│                           3                        Space                                       2                │\n│                           4                        Space                                       2                │\n│                           5                        Space                                       2                │\n│                           6                        Space                                       2                │\n│                           7                        Space                                       2                │\n│                           8                        Space                                       2                │\n│                           9                        Space                                       2                │\n│                           10                       Space                                       2                │\n│                           11                       Space                                       2                │\n│                           12                       Space                                       2                │\n│                           13                       Space                                       2                │\n│                           14                       Space                                       2                │\n│                           15                       Space                                       2                │\n│                           16                       Space                                       2                │\n│                           17                       Space                                       2                │\n│                           18                       Space                                       2                │\n│                           19                       Space                                       2                │\n│                           20                       Space                                       2                │\n│                           21                       Space                                       2                │\n│                                                                                                                 │\n│                               HK_STAT_TIS_DATA_ACQ_TIME PAR_TIS_BIN_MODE PAR_TIS_WIN_SIZE  ...  \\               │\n│                           0                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           1                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           2                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           3                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           4                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           5                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           6                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           7                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           8                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           9                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           10               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           11               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           12               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           13               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           14               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           15               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           16               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           17               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           18               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           19               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           20               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           21               6.511308e+08              1x2      100x80pixel  ...                  │\n│                                                                                                                 │\n│                              HK_STAT_TIS_COMP_NUM_BANDS  HK_STAT_TIS_NUM_OVERSAMP  HK_TEMP_BOL_CHIP  \\          │\n│                           0                           5                         0            15.000             │\n│                           1                           5                        32            14.997             │\n│                           2                           5                        32            15.000             │\n│                           3                           5                        32            15.003             │\n│                           4                           5                        32            15.002             │\n│                           5                           5                        32            15.001             │\n│                           6                           5                        32            15.002             │\n│                           7                           5                        32            15.001             │\n│                           8                           5                        32            15.002             │\n│                           9                           5                        32            15.001             │\n│                           10                          5                        32            15.000             │\n│                           11                          5                        32            14.999             │\n│                           12                          5                        32            15.000             │\n│                           13                          5                        32            15.000             │\n│                           14                          5                        32            15.001             │\n│                           15                          5                        32            15.000             │\n│                           16                          5                        32            15.000             │\n│                           17                          5                        32            15.000             │\n│                           18                          5                        32            14.998             │\n│                           19                          5                        32            15.001             │\n│                           20                          5                        32            14.997             │\n│                           21                          5                         0            14.999             │\n│                                                                                                                 │\n│                               DAT_TIS_OFFSET_MACRO_PIXEL  HK_TEMP_BOL_HOUSING  HK_TEMP_OST_BASE_PLATE  \\        │\n│                           0                            1                9.527                   9.894           │\n│                           1                         2053                9.519                   9.891           │\n│                           2                         2052                9.519                   9.891           │\n│                           3                         2052                9.519                   9.889           │\n│                           4                         2053                9.520                   9.889           │\n│                           5                         2054                9.520                   9.888           │\n│                           6                         2055                9.519                   9.888           │\n│                           7                         2055                9.519                   9.888           │\n│                           8                         2056                9.520                   9.889           │\n│                           9                         2057                9.520                   9.889           │\n│                           10                        2057                9.521                   9.889           │\n│                           11                        2058                9.520                   9.888           │\n│                           12                        2058                9.520                   9.889           │\n│                           13                        2059                9.522                   9.889           │\n│                           14                        2059                9.522                   9.888           │\n│                           15                        2060                9.522                   9.888           │\n│                           16                        2060                9.523                   9.888           │\n│                           17                        2061                9.523                   9.888           │\n│                           18                        2061                9.524                   9.888           │\n│                           19                        2062                9.524                   9.888           │\n│                           20                        2062                9.525                   9.888           │\n│                           21                           1                9.526                   9.888           │\n│                                                                                                                 │\n│                               PAR_TIS_DATA_NOISE_REDUCTION  HK_STAT_TIS_TOTAL_PACKET_NUM  \\                     │\n│                           0                              0                             1                        │\n│                           1                              0                             2                        │\n│                           2                              0                             1                        │\n│                           3                              0                             1                        │\n│                           4                              0                             1                        │\n│                           5                              0                             1                        │\n│                           6                              0                             1                        │\n│                           7                              0                             1                        │\n│                           8                              0                             1                        │\n│                           9                              0                             1                        │\n│                           10                             0                             1                        │\n│                           11                             0                             1                        │\n│                           12                             0                             1                        │\n│                           13                             0                             1                        │\n│                           14                             0                             1                        │\n│                           15                             0                             1                        │\n│                           16                             0                             1                        │\n│                           17                             0                             1                        │\n│                           18                             0                             1                        │\n│                           19                             0                             1                        │\n│                           20                             0                             1                        │\n│                           21                             0                             1                        │\n│                                                                                                                 │\n│                               HK_STAT_TIS_CURRENT_PACKET_NUM  HK_STAT_TIS_NUM_DATA_WORDS                        │\n│                           0                                1                         384                        │\n│                           1                                1                        2028                        │\n│                           2                                1                        1206                        │\n│                           3                                1                        1200                        │\n│                           4                                1                        1208                        │\n│                           5                                1                        1192                        │\n│                           6                                1                        1194                        │\n│                           7                                1                        1204                        │\n│                           8                                1                        1196                        │\n│                           9                                1                        1218                        │\n│                           10                               1                        1200                        │\n│                           11                               1                        1208                        │\n│                           12                               1                        1218                        │\n│                           13                               1                        1214                        │\n│                           14                               1                        1228                        │\n│                           15                               1                        1216                        │\n│                           16                               1                        1214                        │\n│                           17                               1                        1216                        │\n│                           18                               1                        1218                        │\n│                           19                               1                        1218                        │\n│                           20                               1                        1218                        │\n│                           21                               1                         384                        │\n│                                                                                                                 │\n│                           [22 rows x 24 columns]                                                                │\n│                           }                                                                                     │\n│              output_dir = PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│            planet_index = {'mer_raw_sc_tis_20200409_1-0651130819-21186__0_1': Index([], dtype='int64')}         │\n│     planet_index_merged = Index([], dtype='int64')                                                              │\n│        processing_level = 'RAW'                                                                                 │\n│             space_index = {                                                                                     │\n│                               'mer_raw_sc_tis_20200409_1-0651130819-21186__0_1': Index([0, 2, 3, 4, 5, 6, 7, 8, │\n│                           9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,                                        │\n│                                  21],                                                                           │\n│                                 dtype='int64')                                                                  │\n│                           }                                                                                     │\n│      space_index_merged = Index([0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,         │\n│                                  21],                                                                           │\n│                                 dtype='int64')                                                                  │\n│             wavelengths = {'mer_raw_sc_tis_20200409_1-0651130819-21186__0_1': None}                             │\n│          data_assembler = def data_assembler(verbose=False): Assembles the collected data into convenient data  │\n│                           structures.                                                                           │\n│          data_collector = def data_collector(): Collect data from the input files and store it in the           │\n│                           collect_data attribute.                                                               │\n│ detect_processing_level = def detect_processing_level():                                                        │\n│                           Detects the processing level (RAW, CAL, PAR) from the files in the input directory.   │\n│                           Ensures all files have the same level.                                                │\n│          filetypes2dict = def filetypes2dict(): Convert the input files into a dictionary, where the keys are   │\n│                           the file types and the values are lists of file paths.                                │\n│          get_fits_files = def get_fits_files(): Get the list of FITS files.                                     │\n│     get_input_path_dict = def get_input_path_dict(): Get the dictionary of input paths.                         │\n│           listfiletypes = def listfiletypes(): Print the list of file types and the number of files for each    │\n│                           file type.                                                                            │\n│               save_plot = def save_plot(out_file, dpi=150, out_format='jpg'): Save a plot to the output         │\n│                           directory.                                                                            │\n│              set_logger = def set_logger(): Set the logger.                                                     │\n│          set_output_dir = def set_output_dir(output_dir): Set the output directory.                             │\n│              show_files = def show_files(): Print statistics about the files in the input directory.            │\n╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯\n\n\n\n\n\nPAR\n\ninput_path = pathlib.Path('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/par')\nif input_path.exists() :\n    print(f'{input_path=} exists')\nelse :\n    raise FileNotFoundError(f'{input_path=} does not exist')\n# list(input_path.glob('**/*tis*.fits'))\nms = MERTISDataPackReader(input_path,log_level='ERROR')\nrich.print(ms)\n\ninput_path=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/par') exists\n\n\nMERTISDataPackReader(\n  input_dir=../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-\nshort/par\n  output_dir=../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK\n-short/par-analysis_products\n  log_level=ERROR\n  file counts: {\n    hk_default: 1\n    hk_extended: 1\n    sc_tis: 1\n    sc_tir: 0\n    sc_tis_ql: 0\n    sc_tir_ql: 0\n  }\n)\n\n\n\n\nlogging.getLevelName(ms.log.level)\n\n'ERROR'\n\n\n\nms.show_files()\n\nAll files in input_dir :\n\n\nCounter({'.lblx': 4, '.dat': 2, '.fits': 2})\n\n\n\nAll files in input_dir matching old pattern &lt;v0.2.6 (\\d{8}_\\d{8}):\n\n\nCounter()\n\n\n\nAll files in input_dir matching new pattern &gt;=v0.2.6 (mer_cal_sc_tis_YYYYMMDD_1-...):\n\n\nCounter()\n\n\n\n\nms.listfiletypes()\n\n{\n    'hk_default': ['mer_par_hk_default_20200409_1-0651130766-12538__0_1.dat'],\n    'hk_extended': ['mer_par_hk_extended_20200409_1-0651130766-12595__0_1.dat'],\n    'sc_tis': ['mer_par_sc_tis_20200409_1-0651130819-21186__0_1.fits'],\n    'sc_tir': [],\n    'sc_tis_ql': [],\n    'sc_tir_ql': []\n}\n\n\n\n{'hk_default': 1, 'hk_extended': 1, 'sc_tis': 1, 'sc_tir': 0, 'sc_tis_ql': 0, 'sc_tir_ql': 0}\n\n\n\n\n# Collect Data\nms.data_collector()\n\nReading filetype: hk_default from mer_par_hk_default_20200409_1-0651130766-12538__0_1\nReading filetype: hk_extended from mer_par_hk_extended_20200409_1-0651130766-12595__0_1\nReading filetype: tis from mer_par_sc_tis_20200409_1-0651130819-21186__0_1\n\n\n\n# Verify the collected data\nprint(f'Collected data keys: {ms.collect_data.keys()}')\nfor key, value in ms.collect_data.items():\n    print(f'{key}: {len(value)} files collected')\n\nCollected data keys: dict_keys(['hk_default', 'hk_extended', 'tis'])\nhk_default: 1 files collected\nhk_extended: 1 files collected\ntis: 1 files collected\n\n\n\nms.data_assembler()\n\n\n\n\nReading filetype: tis from \n../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/par/me\nr_par_sc_tis_20200409_1-0651130819-21186__0_1.fits\n\n\n\n\n\n\n\nrich.inspect(ms,methods=1)\n\n╭──────────────────────────────────── &lt;class '__main__.MERTISDataPackReader'&gt; ────────────────────────────────────╮\n│ Class to read and process MERTIS data.                                                                          │\n│                                                                                                                 │\n│ ╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────╮ │\n│ │ &lt;MERTISDataPackReader(input_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_C │ │\n│ │ RE-20240717T132010-ParamEventBootSciHK-short/par'),                                                         │ │\n│ │ output_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-Pa │ │\n│ │ ramEventBootSciHK-short/par-analysis_products'), log_level='ERROR')&gt;                                        │ │\n│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │\n│                                                                                                                 │\n│               bb3_index = {'mer_par_sc_tis_20200409_1-0651130819-21186__0_1': Index([1], dtype='int64')}        │\n│        bb3_index_merged = Index([1], dtype='int64')                                                             │\n│               bb7_index = {'mer_par_sc_tis_20200409_1-0651130819-21186__0_1': Index([], dtype='int64')}         │\n│        bb7_index_merged = Index([], dtype='int64')                                                              │\n│            collect_data = {                                                                                     │\n│                               'hk_default': [                                                                   │\n│                                   {                                                                             │\n│                                       'data':                    TIME_UTC            TIME_OBT     TimeStamp     │\n│                           HK_STAT_SID  \\                                                                        │\n│                           0  2020-04-09T05:39:27.578Z  1/0651130766:12538  6.511308e+08            1            │\n│                           1  2020-04-09T05:39:51.858Z  1/0651130790:30939  6.511308e+08            1            │\n│                           2  2020-04-09T05:40:16.050Z  1/0651130814:43482  6.511308e+08            1            │\n│                           3  2020-04-09T05:40:40.327Z  1/0651130838:61650  6.511308e+08            1            │\n│                           4  2020-04-09T05:41:04.522Z  1/0651130863:08879  6.511309e+08            1            │\n│                           5  2020-04-09T05:41:28.796Z  1/0651130887:26854  6.511309e+08            1            │\n│                           6  2020-04-09T05:41:52.987Z  1/0651130911:39353  6.511309e+08            1            │\n│                                                                                                                 │\n│                              PAD  HK_STAT_MERTIS_MODE  FixVal5  HK_STAT_EEPROM_POWER  HK_STAT_EPA_POWER  \\      │\n│                           0    0                   14        0                     0                  0         │\n│                           1    0                   14        0                     0                  0         │\n│                           2    0                   14        0                     0                  0         │\n│                           3    0                   14        0                     0                  0         │\n│                           4    0                   14        0                     0                  0         │\n│                           5    0                   14        0                     0                  0         │\n│                           6    0                   14        0                     0                  0         │\n│                                                                                                                 │\n│                              HK_STAT_HK_POWER  ...  HK_TEMP_PSU  HK_STAT_LAST_ERROR_ID  \\                       │\n│                           0                 1  ...        13.28                  42213                          │\n│                           1                 1  ...        13.28                  42213                          │\n│                           2                 1  ...        13.29                  42213                          │\n│                           3                 1  ...        13.30                  42213                          │\n│                           4                 1  ...        13.30                  42213                          │\n│                           5                 1  ...        13.31                  42213                          │\n│                           6                 1  ...        13.31                  42213                          │\n│                                                                                                                 │\n│                              HK_STAT_LAST_ERROR_FREQUENCY  HK_STAT_NUM_TC_RECEIVED  \\                           │\n│                           0                             1                       46                              │\n│                           1                             1                       46                              │\n│                           2                             1                       46                              │\n│                           3                             1                       46                              │\n│                           4                             1                       46                              │\n│                           5                             1                       46                              │\n│                           6                             1                       46                              │\n│                                                                                                                 │\n│                              HK_STAT_NUM_TC_EXECUTED  HK_STAT_NUM_TM_SENT  HK_STAT_ICU_PROC_DUTY_CYCLE  \\       │\n│                           0                       46                 6441                            7          │\n│                           1                       46                 6467                            7          │\n│                           2                       46                 6494                            6          │\n│                           3                       46                 6520                            7          │\n│                           4                       46                 6547                            7          │\n│                           5                       46                 6573                            7          │\n│                           6                       46                 6600                            6          │\n│                                                                                                                 │\n│                              HK_STAT_ICU_NUM_AHB_ERROR  HK_STAT_ICU_NUM_AHB_CORRECTABLE_ERROR  \\                │\n│                           0                          0                                      0                   │\n│                           1                          0                                      0                   │\n│                           2                          0                                      0                   │\n│                           3                          0                                      0                   │\n│                           4                          0                                      0                   │\n│                           5                          0                                      0                   │\n│                           6                          0                                      0                   │\n│                                                                                                                 │\n│                              HK_STAT_HK_NUM_LATCHUP_ERROR                                                       │\n│                           0                             0                                                       │\n│                           1                             0                                                       │\n│                           2                             0                                                       │\n│                           3                             0                                                       │\n│                           4                             0                                                       │\n│                           5                             0                                                       │\n│                           6                             0                                                       │\n│                                                                                                                 │\n│                           [7 rows x 36 columns],                                                                │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ],                                                                                │\n│                               'hk_extended': [                                                                  │\n│                                   {                                                                             │\n│                                       'data':                    TIME_UTC            TIME_OBT     TimeStamp     │\n│                           HK_STAT_SID  \\                                                                        │\n│                           0  2020-04-09T05:39:27.579Z  1/0651130766:12595  6.511308e+08            2            │\n│                           1  2020-04-09T05:39:51.859Z  1/0651130790:30988  6.511308e+08            2            │\n│                           2  2020-04-09T05:40:16.051Z  1/0651130814:43546  6.511308e+08            2            │\n│                           3  2020-04-09T05:40:40.328Z  1/0651130838:61732  6.511308e+08            2            │\n│                           4  2020-04-09T05:41:04.523Z  1/0651130863:08944  6.511309e+08            2            │\n│                           5  2020-04-09T05:41:28.797Z  1/0651130887:26906  6.511309e+08            2            │\n│                           6  2020-04-09T05:41:52.988Z  1/0651130911:39418  6.511309e+08            2            │\n│                                                                                                                 │\n│                              PAD  HK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET  HK_STAT_SH_REF_TEMP_STABLE  \\         │\n│                           0    0                                       2                           1            │\n│                           1    0                                       2                           1            │\n│                           2    0                                       2                           1            │\n│                           3    0                                       2                           1            │\n│                           4    0                                       2                           1            │\n│                           5    0                                       2                           1            │\n│                           6    0                                       2                           1            │\n│                                                                                                                 │\n│                              HK_STAT_TIS_TEC_STABLE  HK_STAT_EPA_STATUS  FixVal12  ...  \\                       │\n│                           0                       1                   0         0  ...                          │\n│                           1                       1                   0         0  ...                          │\n│                           2                       1                   0         0  ...                          │\n│                           3                       1                   0         0  ...                          │\n│                           4                       1                   0         0  ...                          │\n│                           5                       1                   0         0  ...                          │\n│                           6                       1                   0         0  ...                          │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_CREDIT  HK_STAT_NUM_SPW_ERR_ESCAPE  \\                          │\n│                           0                           0                           0                             │\n│                           1                           0                           0                             │\n│                           2                           0                           0                             │\n│                           3                           0                           0                             │\n│                           4                           0                           0                             │\n│                           5                           0                           0                             │\n│                           6                           0                           0                             │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_DISCONNECT  HK_STAT_NUM_SPW_ERR_PARITY  \\                      │\n│                           0                               0                           0                         │\n│                           1                               0                           0                         │\n│                           2                               0                           0                         │\n│                           3                               0                           0                         │\n│                           4                               0                           0                         │\n│                           5                               0                           0                         │\n│                           6                               0                           0                         │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_WRITESYNC  HK_STAT_NUM_SPW_ERR_INVALIDADDRESS  \\               │\n│                           0                              0                                   0                  │\n│                           1                              0                                   0                  │\n│                           2                              0                                   0                  │\n│                           3                              0                                   0                  │\n│                           4                              0                                   0                  │\n│                           5                              0                                   0                  │\n│                           6                              0                                   0                  │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_EOPEEP  HK_STAT_NUM_SPW_ERR_RXAHB  \\                           │\n│                           0                           0                          0                              │\n│                           1                           0                          0                              │\n│                           2                           0                          0                              │\n│                           3                           0                          0                              │\n│                           4                           0                          0                              │\n│                           5                           0                          0                              │\n│                           6                           0                          0                              │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_TXAHB  HK_STAT_NUM_SPW_ERR_TXBLOCKED                           │\n│                           0                          0                              0                           │\n│                           1                          0                              0                           │\n│                           2                          0                              0                           │\n│                           3                          0                              0                           │\n│                           4                          0                              0                           │\n│                           5                          0                              0                           │\n│                           6                          0                              0                           │\n│                                                                                                                 │\n│                           [7 rows x 44 columns],                                                                │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ],                                                                                │\n│                               'tis': [                                                                          │\n│                                   {                                                                             │\n│                                       'fits_data': [&lt;astropy.io.fits.hdu.image.PrimaryHDU object at             │\n│                           0x7fcdba8a7910&gt;, &lt;astropy.io.fits.hdu.table.BinTableHDU object at 0x7fcdbba47dd0&gt;,    │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdbba396d0&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba92ce10&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba92e050&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba8b3cd0&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba8e4b10&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba8e6450&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba8e5e50&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdbba2dc10&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdbba2e650&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba7cc950&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba7cf790&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba7cf3d0&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdbba2ca10&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba869710&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba8e70d0&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba92e850&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba85e810&gt;],                       │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ]                                                                                 │\n│                           }                                                                                     │\n│              fits_files = [                                                                                     │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                           ]                                                                                     │\n│                  frames = {                                                                                     │\n│                               'mer_par_sc_tis_20200409_1-0651130819-21186__0_1': array([[[ 0.        ,          │\n│                           6.00198761, -0.48701625, ..., -0.89274476,                                            │\n│                                     0.3239171 ,  0.        ],                                                   │\n│                                   [ 0.        ,  6.00261593,  1.55187823, ...,  0.74248739,                     │\n│                                     0.33784851,  0.        ],                                                   │\n│                                   [ 0.        ,  6.00324423,  0.33756872, ..., -0.47197933,                     │\n│                                     0.33737651,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  6.06280533,  0.1609756 , ..., -1.41301436,                     │\n│                                    -1.41304119,  0.        ],                                                   │\n│                                   [ 0.        ,  6.06343085,  0.73438848, ..., -0.49555926,                     │\n│                                    -0.90551243,  0.        ],                                                   │\n│                                   [ 0.        ,  6.06405633,  2.89090448, ...,  0.17089128,                     │\n│                                     2.43740148,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        ,  6.09701917, -1.02144492, ..., -0.23067483,                     │\n│                                    -0.23070193,  0.        ],                                                   │\n│                                   [ 0.        ,  6.09764282,  0.51497198, ...,  0.91356378,                     │\n│                                     1.31229889,  0.        ],                                                   │\n│                                   [ 0.        ,  6.09826644,  0.06347445, ..., -0.74133491,                     │\n│                                    -0.33904255,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  6.15733543,  0.06617018, ..., -0.74615855,                     │\n│                                     0.06596925,  0.        ],                                                   │\n│                                   [ 0.        ,  6.15795526,  0.33814203, ..., -0.49343325,                     │\n│                                    -0.07775988,  0.        ],                                                   │\n│                                   [ 0.        ,  6.15857505,  2.09529404, ..., -0.16225772,                     │\n│                                     1.1921417 ,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        ,  6.19122193, -1.05670122, ..., -0.65421388,                     │\n│                                     0.95640787,  0.        ],                                                   │\n│                                   [ 0.        ,  6.1918393 , -0.58646891, ...,  0.21080402,                     │\n│                                     0.21077618,  0.        ],                                                   │\n│                                   [ 0.        ,  6.19245662,  0.55718206, ...,  0.15448732,                     │\n│                                     0.15445947,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  6.25087667,  0.58973788, ..., -0.92007723,                     │\n│                                    -0.16528706,  0.        ],                                                   │\n│                                   [ 0.        ,  6.25148912, -0.34037687, ..., -1.11606866,                     │\n│                                    -0.72834017,  0.        ],                                                   │\n│                                   [ 0.        ,  6.25210151,  0.37649519, ..., -0.88274148,                     │\n│                                     0.37628868,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  ...,                                                                           │\n│                                                                                                                 │\n│                                  [[ 0.        ,  5.39656933,  0.32518369, ...,  0.54540308,                     │\n│                                     0.9863493 ,  0.        ],                                                   │\n│                                   [ 0.        ,  5.39489042,  0.14379546, ...,  1.01870236,                     │\n│                                     0.58106729,  0.        ],                                                   │\n│                                   [ 0.        ,  5.39321081,  0.33833235, ...,  0.11827947,                     │\n│                                     0.5577903 ,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  5.23052183,  0.28059297, ...,  0.05532487,                     │\n│                                     0.05528172,  0.        ],                                                   │\n│                                   [ 0.        ,  5.22877688,  0.41889389, ..., -0.26850353,                     │\n│                                    -0.03950463,  0.        ],                                                   │\n│                                   [ 0.        ,  5.22703126,  0.88371457, ..., -0.08173815,                     │\n│                                     1.12469557,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        ,  5.13396982,  0.47866116, ..., -0.25665626,                     │\n│                                    -0.01168275,  0.        ],                                                   │\n│                                   [ 0.        ,  5.13218892,  0.03962427, ...,  0.03935563,                     │\n│                                     0.03931291,  0.        ],                                                   │\n│                                   [ 0.        ,  5.13040738,  0.50175363, ...,  1.2323251 ,                     │\n│                                     0.74505568,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  4.95826977, -0.28222277, ..., -0.54451106,                     │\n│                                    -0.54455299,  0.        ],                                                   │\n│                                   [ 0.        ,  4.95642798,  0.65689246, ...,  0.11918691,                     │\n│                                     0.38786596,  0.        ],                                                   │\n│                                   [ 0.        ,  4.95458557,  0.96425223, ..., -0.17610656,                     │\n│                                     0.96394677,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        ,  4.85650004, -0.02004001, ..., -0.02030062,                     │\n│                                     0.30476061,  0.        ],                                                   │\n│                                   [ 0.        ,  4.85462559,  0.33209729, ...,  0.65487448,                     │\n│                                     0.65483304,  0.        ],                                                   │\n│                                   [ 0.        ,  4.85275055,  1.19179017, ...,  0.8587151 ,                     │\n│                                     0.5258591 ,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  4.67202954, -0.38303151, ..., -2.91081687,                     │\n│                                    -2.27897477,  0.        ],                                                   │\n│                                   [ 0.        ,  4.67010069,  1.35645608, ...,  0.69347239,                     │\n│                                     0.69343187,  0.        ],                                                   │\n│                                   [ 0.        ,  4.6681713 ,  0.9782274 , ...,  0.23998391,                     │\n│                                     1.71592096,  0.        ]]], shape=(40, 100, 22))                            │\n│                           }                                                                                     │\n│                 geom_ls = {                                                                                     │\n│                               'mer_par_sc_tis_20200409_1-0651130819-21186__0_1': {                              │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE': array([[[nan, nan, nan, ..., nan,     │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_LATITUDE': array([[[nan, nan, nan, ..., nan, nan, │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LONGITUDE': array([[[nan, nan, nan, ...,   │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LATITUDE': array([[[nan, nan, nan, ...,    │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUB_SUN_LONGITUDE': array([[[nan, nan, nan, ..., nan,    │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUB_SUN_LATITUDE': array([[[nan, nan, nan, ..., nan,     │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_ALTITUDE': array([[[nan, nan, nan, ..., nan, nan, │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_ALTITUDE': array([[[nan, nan, nan, ...,    │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUB_SUN_ALTITUDE': array([[[nan, nan, nan, ..., nan,     │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_DISTANCE': array([[[nan, nan, nan, ..., nan, nan, │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_ANGULAR_DIAMETER': array([[[nan, nan, nan, ...,   │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_LOCAL_TIME': array([[[nan, nan, nan, ..., nan, nan,      │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_PHASE_ANGLE': array([[[nan, nan, nan, ..., nan,   │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_EMISSION_ANGLE': array([[[nan, nan, nan, ...,     │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_INCIDENCE_ANGLE': array([[[nan, nan, nan, ...,    │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 22))                    │\n│                               }                                                                                 │\n│                           }                                                                                     │\n│               input_dir = PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│         input_path_dict = {                                                                                     │\n│                               'hk_default': [                                                                   │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'hk_extended': [                                                                  │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'sc_tis': [                                                                       │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'sc_tir': [],                                                                     │\n│                               'sc_tis_ql': [],                                                                  │\n│                               'sc_tir_ql': []                                                                   │\n│                           }                                                                                     │\n│                     log = &lt;RootLogger root (ERROR)&gt;                                                             │\n│               log_level = 'ERROR'                                                                               │\n│     mertis_tis_metadata = {                                                                                     │\n│                               'mer_par_sc_tis_20200409_1-0651130819-21186__0_1':                     TIME_UTC   │\n│                           TIME_OBT     TimeStamp  \\                                                             │\n│                           0   2020-04-09T05:40:20.710Z  1/0651130819:21186  6.511308e+08                        │\n│                           1   2020-04-09T05:40:28.335Z  1/0651130826:62158  6.511308e+08                        │\n│                           2   2020-04-09T05:40:31.748Z  1/0651130830:23689  6.511308e+08                        │\n│                           3   2020-04-09T05:40:32.548Z  1/0651130831:10567  6.511308e+08                        │\n│                           4   2020-04-09T05:40:33.348Z  1/0651130831:62998  6.511308e+08                        │\n│                           5   2020-04-09T05:40:34.148Z  1/0651130832:49891  6.511308e+08                        │\n│                           6   2020-04-09T05:40:34.948Z  1/0651130833:36784  6.511308e+08                        │\n│                           7   2020-04-09T05:40:35.748Z  1/0651130834:23676  6.511308e+08                        │\n│                           8   2020-04-09T05:40:36.548Z  1/0651130835:10569  6.511308e+08                        │\n│                           9   2020-04-09T05:40:37.348Z  1/0651130835:62998  6.511308e+08                        │\n│                           10  2020-04-09T05:40:38.148Z  1/0651130836:49891  6.511308e+08                        │\n│                           11  2020-04-09T05:40:38.948Z  1/0651130837:36783  6.511308e+08                        │\n│                           12  2020-04-09T05:40:39.748Z  1/0651130838:23676  6.511308e+08                        │\n│                           13  2020-04-09T05:40:40.548Z  1/0651130839:10569  6.511308e+08                        │\n│                           14  2020-04-09T05:40:41.348Z  1/0651130839:62998  6.511308e+08                        │\n│                           15  2020-04-09T05:40:42.148Z  1/0651130840:49891  6.511308e+08                        │\n│                           16  2020-04-09T05:40:42.948Z  1/0651130841:36783  6.511308e+08                        │\n│                           17  2020-04-09T05:40:43.748Z  1/0651130842:23676  6.511308e+08                        │\n│                           18  2020-04-09T05:40:44.548Z  1/0651130843:10569  6.511308e+08                        │\n│                           19  2020-04-09T05:40:45.348Z  1/0651130843:62998  6.511308e+08                        │\n│                           20  2020-04-09T05:40:46.148Z  1/0651130844:49891  6.511308e+08                        │\n│                           21  2020-04-09T05:40:46.948Z  1/0651130845:36784  6.511308e+08                        │\n│                                                                                                                 │\n│                               HK_STAT_TIS_DATA_ACQ_ID HK_STAT_TIS_DATA_ACQ_TYPE  \\                              │\n│                           0                      3740                   Sci_Raw                                 │\n│                           1                      3742                   Sci_Raw                                 │\n│                           2                      3743        Sci_Subtracted_BB3                                 │\n│                           3                      3744        Sci_Subtracted_BB3                                 │\n│                           4                      3745        Sci_Subtracted_BB3                                 │\n│                           5                      3746        Sci_Subtracted_BB3                                 │\n│                           6                      3747        Sci_Subtracted_BB3                                 │\n│                           7                      3748        Sci_Subtracted_BB3                                 │\n│                           8                      3749        Sci_Subtracted_BB3                                 │\n│                           9                      3750        Sci_Subtracted_BB3                                 │\n│                           10                     3751        Sci_Subtracted_BB3                                 │\n│                           11                     3752        Sci_Subtracted_BB3                                 │\n│                           12                     3753        Sci_Subtracted_BB3                                 │\n│                           13                     3754        Sci_Subtracted_BB3                                 │\n│                           14                     3755        Sci_Subtracted_BB3                                 │\n│                           15                     3756        Sci_Subtracted_BB3                                 │\n│                           16                     3757        Sci_Subtracted_BB3                                 │\n│                           17                     3758        Sci_Subtracted_BB3                                 │\n│                           18                     3759        Sci_Subtracted_BB3                                 │\n│                           19                     3760        Sci_Subtracted_BB3                                 │\n│                           20                     3761        Sci_Subtracted_BB3                                 │\n│                           21                     3762                   Sci_Raw                                 │\n│                                                                                                                 │\n│                              HK_STAT_TIS_DATA_ACQ_TARGET  HK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET  \\             │\n│                           0                        Space                                       2                │\n│                           1                          BB3                                       2                │\n│                           2                        Space                                       2                │\n│                           3                        Space                                       2                │\n│                           4                        Space                                       2                │\n│                           5                        Space                                       2                │\n│                           6                        Space                                       2                │\n│                           7                        Space                                       2                │\n│                           8                        Space                                       2                │\n│                           9                        Space                                       2                │\n│                           10                       Space                                       2                │\n│                           11                       Space                                       2                │\n│                           12                       Space                                       2                │\n│                           13                       Space                                       2                │\n│                           14                       Space                                       2                │\n│                           15                       Space                                       2                │\n│                           16                       Space                                       2                │\n│                           17                       Space                                       2                │\n│                           18                       Space                                       2                │\n│                           19                       Space                                       2                │\n│                           20                       Space                                       2                │\n│                           21                       Space                                       2                │\n│                                                                                                                 │\n│                               HK_STAT_TIS_DATA_ACQ_TIME PAR_TIS_BIN_MODE PAR_TIS_WIN_SIZE  ...  \\               │\n│                           0                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           1                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           2                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           3                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           4                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           5                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           6                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           7                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           8                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           9                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           10               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           11               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           12               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           13               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           14               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           15               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           16               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           17               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           18               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           19               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           20               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           21               6.511308e+08              1x2      100x80pixel  ...                  │\n│                                                                                                                 │\n│                              HK_STAT_TIS_COMP_NUM_BANDS  HK_STAT_TIS_NUM_OVERSAMP  HK_TEMP_BOL_CHIP  \\          │\n│                           0                           5                         0            15.000             │\n│                           1                           5                        32            14.997             │\n│                           2                           5                        32            15.000             │\n│                           3                           5                        32            15.003             │\n│                           4                           5                        32            15.002             │\n│                           5                           5                        32            15.001             │\n│                           6                           5                        32            15.002             │\n│                           7                           5                        32            15.001             │\n│                           8                           5                        32            15.002             │\n│                           9                           5                        32            15.001             │\n│                           10                          5                        32            15.000             │\n│                           11                          5                        32            14.999             │\n│                           12                          5                        32            15.000             │\n│                           13                          5                        32            15.000             │\n│                           14                          5                        32            15.001             │\n│                           15                          5                        32            15.000             │\n│                           16                          5                        32            15.000             │\n│                           17                          5                        32            15.000             │\n│                           18                          5                        32            14.998             │\n│                           19                          5                        32            15.001             │\n│                           20                          5                        32            14.997             │\n│                           21                          5                         0            14.999             │\n│                                                                                                                 │\n│                               DAT_TIS_OFFSET_MACRO_PIXEL  HK_TEMP_BOL_HOUSING  HK_TEMP_OST_BASE_PLATE  \\        │\n│                           0                            1                9.527                   9.894           │\n│                           1                         2053                9.519                   9.891           │\n│                           2                         2052                9.519                   9.891           │\n│                           3                         2052                9.519                   9.889           │\n│                           4                         2053                9.520                   9.889           │\n│                           5                         2054                9.520                   9.888           │\n│                           6                         2055                9.519                   9.888           │\n│                           7                         2055                9.519                   9.888           │\n│                           8                         2056                9.520                   9.889           │\n│                           9                         2057                9.520                   9.889           │\n│                           10                        2057                9.521                   9.889           │\n│                           11                        2058                9.520                   9.888           │\n│                           12                        2058                9.520                   9.889           │\n│                           13                        2059                9.522                   9.889           │\n│                           14                        2059                9.522                   9.888           │\n│                           15                        2060                9.522                   9.888           │\n│                           16                        2060                9.523                   9.888           │\n│                           17                        2061                9.523                   9.888           │\n│                           18                        2061                9.524                   9.888           │\n│                           19                        2062                9.524                   9.888           │\n│                           20                        2062                9.525                   9.888           │\n│                           21                           1                9.526                   9.888           │\n│                                                                                                                 │\n│                               PAR_TIS_DATA_NOISE_REDUCTION  HK_STAT_TIS_TOTAL_PACKET_NUM  \\                     │\n│                           0                              0                             1                        │\n│                           1                              0                             2                        │\n│                           2                              0                             1                        │\n│                           3                              0                             1                        │\n│                           4                              0                             1                        │\n│                           5                              0                             1                        │\n│                           6                              0                             1                        │\n│                           7                              0                             1                        │\n│                           8                              0                             1                        │\n│                           9                              0                             1                        │\n│                           10                             0                             1                        │\n│                           11                             0                             1                        │\n│                           12                             0                             1                        │\n│                           13                             0                             1                        │\n│                           14                             0                             1                        │\n│                           15                             0                             1                        │\n│                           16                             0                             1                        │\n│                           17                             0                             1                        │\n│                           18                             0                             1                        │\n│                           19                             0                             1                        │\n│                           20                             0                             1                        │\n│                           21                             0                             1                        │\n│                                                                                                                 │\n│                               HK_STAT_TIS_CURRENT_PACKET_NUM  HK_STAT_TIS_NUM_DATA_WORDS                        │\n│                           0                                1                         384                        │\n│                           1                                1                        2028                        │\n│                           2                                1                        1206                        │\n│                           3                                1                        1200                        │\n│                           4                                1                        1208                        │\n│                           5                                1                        1192                        │\n│                           6                                1                        1194                        │\n│                           7                                1                        1204                        │\n│                           8                                1                        1196                        │\n│                           9                                1                        1218                        │\n│                           10                               1                        1200                        │\n│                           11                               1                        1208                        │\n│                           12                               1                        1218                        │\n│                           13                               1                        1214                        │\n│                           14                               1                        1228                        │\n│                           15                               1                        1216                        │\n│                           16                               1                        1214                        │\n│                           17                               1                        1216                        │\n│                           18                               1                        1218                        │\n│                           19                               1                        1218                        │\n│                           20                               1                        1218                        │\n│                           21                               1                         384                        │\n│                                                                                                                 │\n│                           [22 rows x 24 columns]                                                                │\n│                           }                                                                                     │\n│              output_dir = PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│            planet_index = {'mer_par_sc_tis_20200409_1-0651130819-21186__0_1': Index([], dtype='int64')}         │\n│     planet_index_merged = Index([], dtype='int64')                                                              │\n│        processing_level = 'PAR'                                                                                 │\n│             space_index = {                                                                                     │\n│                               'mer_par_sc_tis_20200409_1-0651130819-21186__0_1': Index([0, 2, 3, 4, 5, 6, 7, 8, │\n│                           9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,                                        │\n│                                  21],                                                                           │\n│                                 dtype='int64')                                                                  │\n│                           }                                                                                     │\n│      space_index_merged = Index([0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,         │\n│                                  21],                                                                           │\n│                                 dtype='int64')                                                                  │\n│             wavelengths = {                                                                                     │\n│                               'mer_par_sc_tis_20200409_1-0651130819-21186__0_1': array([[13.93365627,           │\n│                           13.93248339, 13.93131051, ..., 13.81988688,                                           │\n│                                   13.818714  , 13.81754112],                                                    │\n│                                  [13.75564164, 13.75446876, 13.75329588, ..., 13.64187226,                      │\n│                                   13.64069938, 13.6395265 ],                                                    │\n│                                  [13.57762702, 13.57645414, 13.57528126, ..., 13.46385764,                      │\n│                                   13.46268476, 13.46151188],                                                    │\n│                                  ...,                                                                           │\n│                                  [ 7.34711524,  7.34594236,  7.34476948, ...,  7.23334586,                      │\n│                                    7.23217298,  7.2310001 ],                                                    │\n│                                  [ 7.16910062,  7.16792774,  7.16675486, ...,  7.05533124,                      │\n│                                    7.05415836,  7.05298548],                                                    │\n│                                  [ 6.991086  ,  6.98991312,  6.98874024, ...,  6.87731661,                      │\n│                                    6.87614373,  6.87497085]], shape=(40, 100))                                  │\n│                           }                                                                                     │\n│          data_assembler = def data_assembler(verbose=False): Assembles the collected data into convenient data  │\n│                           structures.                                                                           │\n│          data_collector = def data_collector(): Collect data from the input files and store it in the           │\n│                           collect_data attribute.                                                               │\n│ detect_processing_level = def detect_processing_level():                                                        │\n│                           Detects the processing level (RAW, CAL, PAR) from the files in the input directory.   │\n│                           Ensures all files have the same level.                                                │\n│          filetypes2dict = def filetypes2dict(): Convert the input files into a dictionary, where the keys are   │\n│                           the file types and the values are lists of file paths.                                │\n│          get_fits_files = def get_fits_files(): Get the list of FITS files.                                     │\n│     get_input_path_dict = def get_input_path_dict(): Get the dictionary of input paths.                         │\n│           listfiletypes = def listfiletypes(): Print the list of file types and the number of files for each    │\n│                           file type.                                                                            │\n│               save_plot = def save_plot(out_file, dpi=150, out_format='jpg'): Save a plot to the output         │\n│                           directory.                                                                            │\n│              set_logger = def set_logger(): Set the logger.                                                     │\n│          set_output_dir = def set_output_dir(output_dir): Set the output directory.                             │\n│              show_files = def show_files(): Print statistics about the files in the input directory.            │\n╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯\n\n\n\n\n\nCAL\n\ninput_path = pathlib.Path('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal')\nif input_path.exists() :\n    print(f'{input_path=} exists')\nelse :\n    raise FileNotFoundError(f'{input_path=} does not exist')\n# list(input_path.glob('**/*tis*.fits'))\nms = MERTISDataPackReader(input_path,log_level='ERROR')\nms\n\ninput_path=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal') exists\n\n\n&lt;MERTISDataPackReader(input_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal'), output_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal-analysis_products'), log_level='ERROR')&gt;\n\n\n\nlogging.getLevelName(ms.log.level)\n\n'ERROR'\n\n\n\nms.show_files()\n\nAll files in input_dir :\n\n\nCounter({'.dat': 2, '.lblx': 3, '.fits': 1})\n\n\n\nAll files in input_dir matching old pattern &lt;v0.2.6 (\\d{8}_\\d{8}):\n\n\nCounter()\n\n\n\nAll files in input_dir matching new pattern &gt;=v0.2.6 (mer_cal_sc_tis_YYYYMMDD_1-...):\n\n\nCounter({'mer_cal_sc_tis': 1})\n\n\n\n\nms.listfiletypes()\n\n{\n    'hk_default': ['mer_cal_hk_default_20200409_1-0651130766-12538__0_1.dat'],\n    'hk_extended': ['mer_cal_hk_extended_20200409_1-0651130766-12595__0_1.dat'],\n    'sc_tis': ['mer_cal_sc_tis_20200409_1-0651130819-21186__0_1.fits'],\n    'sc_tir': [],\n    'sc_tis_ql': [],\n    'sc_tir_ql': []\n}\n\n\n\n{'hk_default': 1, 'hk_extended': 1, 'sc_tis': 1, 'sc_tir': 0, 'sc_tis_ql': 0, 'sc_tir_ql': 0}\n\n\n\n\n# Collect Data\nms.data_collector()\n\nReading filetype: hk_default from mer_cal_hk_default_20200409_1-0651130766-12538__0_1\nReading filetype: hk_extended from mer_cal_hk_extended_20200409_1-0651130766-12595__0_1\nReading filetype: tis from mer_cal_sc_tis_20200409_1-0651130819-21186__0_1\n\n\n\n# Verify the collected data\nprint(f'Collected data keys: {ms.collect_data.keys()}')\nfor key, value in ms.collect_data.items():\n    print(f'{key}: {len(value)} files collected')\n\nCollected data keys: dict_keys(['hk_default', 'hk_extended', 'tis'])\nhk_default: 1 files collected\nhk_extended: 1 files collected\ntis: 1 files collected\n\n\n\nms.data_assembler()\n\n\n\n\nReading filetype: tis from \n../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-ParamEventBootSciHK-short/cal/me\nr_cal_sc_tis_20200409_1-0651130819-21186__0_1.fits\n\n\n\n\n\n\n\nrich.inspect(ms,methods=1)\n\n╭──────────────────────────────────── &lt;class '__main__.MERTISDataPackReader'&gt; ────────────────────────────────────╮\n│ Class to read and process MERTIS data.                                                                          │\n│                                                                                                                 │\n│ ╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────╮ │\n│ │ &lt;MERTISDataPackReader(input_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_C │ │\n│ │ RE-20240717T132010-ParamEventBootSciHK-short/cal'),                                                         │ │\n│ │ output_dir=PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20240717T132010-Pa │ │\n│ │ ramEventBootSciHK-short/cal-analysis_products'), log_level='ERROR')&gt;                                        │ │\n│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │\n│                                                                                                                 │\n│               bb3_index = {'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1': Index([], dtype='int64')}         │\n│        bb3_index_merged = Index([], dtype='int64')                                                              │\n│               bb7_index = {'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1': Index([], dtype='int64')}         │\n│        bb7_index_merged = Index([], dtype='int64')                                                              │\n│            collect_data = {                                                                                     │\n│                               'hk_default': [                                                                   │\n│                                   {                                                                             │\n│                                       'data':                    TIME_UTC            TIME_OBT     TimeStamp     │\n│                           HK_STAT_SID  \\                                                                        │\n│                           0  2020-04-09T05:39:27.578Z  1/0651130766:12538  6.511308e+08            1            │\n│                           1  2020-04-09T05:39:51.858Z  1/0651130790:30939  6.511308e+08            1            │\n│                           2  2020-04-09T05:40:16.050Z  1/0651130814:43482  6.511308e+08            1            │\n│                           3  2020-04-09T05:40:40.327Z  1/0651130838:61650  6.511308e+08            1            │\n│                           4  2020-04-09T05:41:04.522Z  1/0651130863:08879  6.511309e+08            1            │\n│                           5  2020-04-09T05:41:28.796Z  1/0651130887:26854  6.511309e+08            1            │\n│                           6  2020-04-09T05:41:52.987Z  1/0651130911:39353  6.511309e+08            1            │\n│                                                                                                                 │\n│                              PAD  HK_STAT_MERTIS_MODE  FixVal5  HK_STAT_EEPROM_POWER  HK_STAT_EPA_POWER  \\      │\n│                           0    0                   14        0                     0                  0         │\n│                           1    0                   14        0                     0                  0         │\n│                           2    0                   14        0                     0                  0         │\n│                           3    0                   14        0                     0                  0         │\n│                           4    0                   14        0                     0                  0         │\n│                           5    0                   14        0                     0                  0         │\n│                           6    0                   14        0                     0                  0         │\n│                                                                                                                 │\n│                              HK_STAT_HK_POWER  ...  HK_TEMP_PSU  HK_STAT_LAST_ERROR_ID  \\                       │\n│                           0                 1  ...        13.28                  42213                          │\n│                           1                 1  ...        13.28                  42213                          │\n│                           2                 1  ...        13.29                  42213                          │\n│                           3                 1  ...        13.30                  42213                          │\n│                           4                 1  ...        13.30                  42213                          │\n│                           5                 1  ...        13.31                  42213                          │\n│                           6                 1  ...        13.31                  42213                          │\n│                                                                                                                 │\n│                              HK_STAT_LAST_ERROR_FREQUENCY  HK_STAT_NUM_TC_RECEIVED  \\                           │\n│                           0                             1                       46                              │\n│                           1                             1                       46                              │\n│                           2                             1                       46                              │\n│                           3                             1                       46                              │\n│                           4                             1                       46                              │\n│                           5                             1                       46                              │\n│                           6                             1                       46                              │\n│                                                                                                                 │\n│                              HK_STAT_NUM_TC_EXECUTED  HK_STAT_NUM_TM_SENT  HK_STAT_ICU_PROC_DUTY_CYCLE  \\       │\n│                           0                       46                 6441                            7          │\n│                           1                       46                 6467                            7          │\n│                           2                       46                 6494                            6          │\n│                           3                       46                 6520                            7          │\n│                           4                       46                 6547                            7          │\n│                           5                       46                 6573                            7          │\n│                           6                       46                 6600                            6          │\n│                                                                                                                 │\n│                              HK_STAT_ICU_NUM_AHB_ERROR  HK_STAT_ICU_NUM_AHB_CORRECTABLE_ERROR  \\                │\n│                           0                          0                                      0                   │\n│                           1                          0                                      0                   │\n│                           2                          0                                      0                   │\n│                           3                          0                                      0                   │\n│                           4                          0                                      0                   │\n│                           5                          0                                      0                   │\n│                           6                          0                                      0                   │\n│                                                                                                                 │\n│                              HK_STAT_HK_NUM_LATCHUP_ERROR                                                       │\n│                           0                             0                                                       │\n│                           1                             0                                                       │\n│                           2                             0                                                       │\n│                           3                             0                                                       │\n│                           4                             0                                                       │\n│                           5                             0                                                       │\n│                           6                             0                                                       │\n│                                                                                                                 │\n│                           [7 rows x 36 columns],                                                                │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ],                                                                                │\n│                               'hk_extended': [                                                                  │\n│                                   {                                                                             │\n│                                       'data':                    TIME_UTC            TIME_OBT     TimeStamp     │\n│                           HK_STAT_SID  \\                                                                        │\n│                           0  2020-04-09T05:39:27.579Z  1/0651130766:12595  6.511308e+08            2            │\n│                           1  2020-04-09T05:39:51.859Z  1/0651130790:30988  6.511308e+08            2            │\n│                           2  2020-04-09T05:40:16.051Z  1/0651130814:43546  6.511308e+08            2            │\n│                           3  2020-04-09T05:40:40.328Z  1/0651130838:61732  6.511308e+08            2            │\n│                           4  2020-04-09T05:41:04.523Z  1/0651130863:08944  6.511309e+08            2            │\n│                           5  2020-04-09T05:41:28.797Z  1/0651130887:26906  6.511309e+08            2            │\n│                           6  2020-04-09T05:41:52.988Z  1/0651130911:39418  6.511309e+08            2            │\n│                                                                                                                 │\n│                              PAD  HK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET  HK_STAT_SH_REF_TEMP_STABLE  \\         │\n│                           0    0                                       2                           1            │\n│                           1    0                                       2                           1            │\n│                           2    0                                       2                           1            │\n│                           3    0                                       2                           1            │\n│                           4    0                                       2                           1            │\n│                           5    0                                       2                           1            │\n│                           6    0                                       2                           1            │\n│                                                                                                                 │\n│                              HK_STAT_TIS_TEC_STABLE  HK_STAT_EPA_STATUS  FixVal12  ...  \\                       │\n│                           0                       1                   0         0  ...                          │\n│                           1                       1                   0         0  ...                          │\n│                           2                       1                   0         0  ...                          │\n│                           3                       1                   0         0  ...                          │\n│                           4                       1                   0         0  ...                          │\n│                           5                       1                   0         0  ...                          │\n│                           6                       1                   0         0  ...                          │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_CREDIT  HK_STAT_NUM_SPW_ERR_ESCAPE  \\                          │\n│                           0                           0                           0                             │\n│                           1                           0                           0                             │\n│                           2                           0                           0                             │\n│                           3                           0                           0                             │\n│                           4                           0                           0                             │\n│                           5                           0                           0                             │\n│                           6                           0                           0                             │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_DISCONNECT  HK_STAT_NUM_SPW_ERR_PARITY  \\                      │\n│                           0                               0                           0                         │\n│                           1                               0                           0                         │\n│                           2                               0                           0                         │\n│                           3                               0                           0                         │\n│                           4                               0                           0                         │\n│                           5                               0                           0                         │\n│                           6                               0                           0                         │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_WRITESYNC  HK_STAT_NUM_SPW_ERR_INVALIDADDRESS  \\               │\n│                           0                              0                                   0                  │\n│                           1                              0                                   0                  │\n│                           2                              0                                   0                  │\n│                           3                              0                                   0                  │\n│                           4                              0                                   0                  │\n│                           5                              0                                   0                  │\n│                           6                              0                                   0                  │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_EOPEEP  HK_STAT_NUM_SPW_ERR_RXAHB  \\                           │\n│                           0                           0                          0                              │\n│                           1                           0                          0                              │\n│                           2                           0                          0                              │\n│                           3                           0                          0                              │\n│                           4                           0                          0                              │\n│                           5                           0                          0                              │\n│                           6                           0                          0                              │\n│                                                                                                                 │\n│                              HK_STAT_NUM_SPW_ERR_TXAHB  HK_STAT_NUM_SPW_ERR_TXBLOCKED                           │\n│                           0                          0                              0                           │\n│                           1                          0                              0                           │\n│                           2                          0                              0                           │\n│                           3                          0                              0                           │\n│                           4                          0                              0                           │\n│                           5                          0                              0                           │\n│                           6                          0                              0                           │\n│                                                                                                                 │\n│                           [7 rows x 44 columns],                                                                │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ],                                                                                │\n│                               'tis': [                                                                          │\n│                                   {                                                                             │\n│                                       'fits_data': [&lt;astropy.io.fits.hdu.image.PrimaryHDU object at             │\n│                           0x7fcdba8ac550&gt;, &lt;astropy.io.fits.hdu.table.BinTableHDU object at 0x7fcdba627cd0&gt;,    │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba625c50&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdb8da2390&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba942190&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba9438d0&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba73e210&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdc06c0a90&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba64be10&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba64b810&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdb8d5a050&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdb8d59150&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdb8d5a8d0&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdb8d3d790&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba788450&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba788c90&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdb8d3f8d0&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba64a850&gt;,                        │\n│                           &lt;astropy.io.fits.hdu.image.ImageHDU object at 0x7fcdba73c450&gt;],                       │\n│                                       'path':                                                                   │\n│                           PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│                                   }                                                                             │\n│                               ]                                                                                 │\n│                           }                                                                                     │\n│              fits_files = [                                                                                     │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                               PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-20… │\n│                           ]                                                                                     │\n│                  frames = {                                                                                     │\n│                               'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1': array([[[ 0.        ,          │\n│                           -0.48701625, -0.08145351, ..., -0.89274476,                                           │\n│                                     0.3239171 ,  0.        ],                                                   │\n│                                   [ 0.        ,  1.55187823,  1.55187823, ...,  0.74248739,                     │\n│                                     0.33784851,  0.        ],                                                   │\n│                                   [ 0.        ,  0.33756872,  0.33756872, ..., -0.47197933,                     │\n│                                     0.33737651,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  0.1609756 , -0.62593503, ..., -1.41301436,                     │\n│                                    -1.41304119,  0.        ],                                                   │\n│                                   [ 0.        ,  0.73438848,  0.32446215, ..., -0.49555926,                     │\n│                                    -0.90551243,  0.        ],                                                   │\n│                                   [ 0.        ,  2.89090448,  1.98428967, ...,  0.17089128,                     │\n│                                     2.43740148,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        , -1.02144492, -0.23050446, ..., -0.23067483,                     │\n│                                    -0.23070193,  0.        ],                                                   │\n│                                   [ 0.        ,  0.51497198,  1.31249638, ...,  0.91356378,                     │\n│                                     1.31229889,  0.        ],                                                   │\n│                                   [ 0.        ,  0.06347445, -0.33884501, ..., -0.74133491,                     │\n│                                    -0.33904255,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  0.06617018,  0.06617018, ..., -0.74615855,                     │\n│                                     0.06596925,  0.        ],                                                   │\n│                                   [ 0.        ,  0.33814203,  0.33814203, ..., -0.49343325,                     │\n│                                    -0.07775988,  0.        ],                                                   │\n│                                   [ 0.        ,  2.09529404,  1.1923427 , ..., -0.16225772,                     │\n│                                     1.1921417 ,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        , -1.05670122, -0.65403882, ..., -0.65421388,                     │\n│                                     0.95640787,  0.        ],                                                   │\n│                                   [ 0.        , -0.58646891,  0.21097911, ...,  0.21080402,                     │\n│                                     0.21077618,  0.        ],                                                   │\n│                                   [ 0.        ,  0.55718206,  0.55718206, ...,  0.15448732,                     │\n│                                     0.15445947,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  0.58973788, -0.16508062, ..., -0.92007723,                     │\n│                                    -0.16528706,  0.        ],                                                   │\n│                                   [ 0.        , -0.34037687, -0.34037687, ..., -1.11606866,                     │\n│                                    -0.72834017,  0.        ],                                                   │\n│                                   [ 0.        ,  0.37649519, -0.04319098, ..., -0.88274148,                     │\n│                                     0.37628868,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  ...,                                                                           │\n│                                                                                                                 │\n│                                  [[ 0.        ,  0.32518369,  0.54567872, ...,  0.54540308,                     │\n│                                     0.9863493 ,  0.        ],                                                   │\n│                                   [ 0.        ,  0.14379546,  0.36259109, ...,  1.01870236,                     │\n│                                     0.58106729,  0.        ],                                                   │\n│                                   [ 0.        ,  0.33833235,  0.55810967, ...,  0.11827947,                     │\n│                                     0.5577903 ,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        ,  0.28059297,  0.28059297, ...,  0.05532487,                     │\n│                                     0.05528172,  0.        ],                                                   │\n│                                   [ 0.        ,  0.41889389, -0.03919021, ..., -0.26850353,                     │\n│                                    -0.03950463,  0.        ],                                                   │\n│                                   [ 0.        ,  0.88371457,  0.88371457, ..., -0.08173815,                     │\n│                                     1.12469557,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        ,  0.47866116,  0.47866116, ..., -0.25665626,                     │\n│                                    -0.01168275,  0.        ],                                                   │\n│                                   [ 0.        ,  0.03962427,  0.52463043, ...,  0.03935563,                     │\n│                                     0.03931291,  0.        ],                                                   │\n│                                   [ 0.        ,  0.50175363,  0.74536699, ...,  1.2323251 ,                     │\n│                                     0.74505568,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        , -0.28222277,  0.24182648, ..., -0.54451106,                     │\n│                                    -0.54455299,  0.        ],                                                   │\n│                                   [ 0.        ,  0.65689246,  0.65689246, ...,  0.11918691,                     │\n│                                     0.38786596,  0.        ],                                                   │\n│                                   [ 0.        ,  0.96425223,  0.96425223, ..., -0.17610656,                     │\n│                                     0.96394677,  0.        ]],                                                  │\n│                                                                                                                 │\n│                                  [[ 0.        , -0.02004001,  0.63016533, ..., -0.02030062,                     │\n│                                     0.30476061,  0.        ],                                                   │\n│                                   [ 0.        ,  0.33209729,  0.97817276, ...,  0.65487448,                     │\n│                                     0.65483304,  0.        ],                                                   │\n│                                   [ 0.        ,  1.19179017,  1.85741933, ...,  0.8587151 ,                     │\n│                                     0.5258591 ,  0.        ],                                                   │\n│                                   ...,                                                                          │\n│                                   [ 0.        , -0.38303151, -1.01491414, ..., -2.91081687,                     │\n│                                    -2.27897477,  0.        ],                                                   │\n│                                   [ 0.        ,  1.35645608,  0.03099824, ...,  0.69347239,                     │\n│                                     0.69343187,  0.        ],                                                   │\n│                                   [ 0.        ,  0.9782274 ,  0.9782274 , ...,  0.23998391,                     │\n│                                     1.71592096,  0.        ]]], shape=(40, 100, 21))                            │\n│                           }                                                                                     │\n│                 geom_ls = {                                                                                     │\n│                               'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1': {                              │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_LONGITUDE': array([[[nan, nan, nan, ..., nan,     │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_LATITUDE': array([[[nan, nan, nan, ..., nan, nan, │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LONGITUDE': array([[[nan, nan, nan, ...,   │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_LATITUDE': array([[[nan, nan, nan, ...,    │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUB_SUN_LONGITUDE': array([[[nan, nan, nan, ..., nan,    │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUB_SUN_LATITUDE': array([[[nan, nan, nan, ..., nan,     │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_ALTITUDE': array([[[nan, nan, nan, ..., nan, nan, │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUBSPACECRAFT_ALTITUDE': array([[[nan, nan, nan, ...,    │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_SUB_SUN_ALTITUDE': array([[[nan, nan, nan, ..., nan,     │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_DISTANCE': array([[[nan, nan, nan, ..., nan, nan, │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_ANGULAR_DIAMETER': array([[[nan, nan, nan, ...,   │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_LOCAL_TIME': array([[[nan, nan, nan, ..., nan, nan,      │\n│                           nan],                                                                                 │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_PHASE_ANGLE': array([[[nan, nan, nan, ..., nan,   │\n│                           nan, nan],                                                                            │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_EMISSION_ANGLE': array([[[nan, nan, nan, ...,     │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21)),                   │\n│                                   'MERTIS_TIS_GEOMETRY_TARGET_INCIDENCE_ANGLE': array([[[nan, nan, nan, ...,    │\n│                           nan, nan, nan],                                                                       │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]],                                         │\n│                                                                                                                 │\n│                                  [[nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   ...,                                                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan],                                          │\n│                                   [nan, nan, nan, ..., nan, nan, nan]]], shape=(5, 100, 21))                    │\n│                               }                                                                                 │\n│                           }                                                                                     │\n│               input_dir = PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│         input_path_dict = {                                                                                     │\n│                               'hk_default': [                                                                   │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'hk_extended': [                                                                  │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'sc_tis': [                                                                       │\n│                                   PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CR… │\n│                               ],                                                                                │\n│                               'sc_tir': [],                                                                     │\n│                               'sc_tis_ql': [],                                                                  │\n│                               'sc_tir_ql': []                                                                   │\n│                           }                                                                                     │\n│                     log = &lt;RootLogger root (ERROR)&gt;                                                             │\n│               log_level = 'ERROR'                                                                               │\n│     mertis_tis_metadata = {                                                                                     │\n│                               'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1':                     TIME_UTC   │\n│                           TIME_OBT     TimeStamp  \\                                                             │\n│                           0   2020-04-09T05:40:20.710Z  1/0651130819:21186  6.511308e+08                        │\n│                           1   2020-04-09T05:40:31.748Z  1/0651130830:23689  6.511308e+08                        │\n│                           2   2020-04-09T05:40:32.548Z  1/0651130831:10567  6.511308e+08                        │\n│                           3   2020-04-09T05:40:33.348Z  1/0651130831:62998  6.511308e+08                        │\n│                           4   2020-04-09T05:40:34.148Z  1/0651130832:49891  6.511308e+08                        │\n│                           5   2020-04-09T05:40:34.948Z  1/0651130833:36784  6.511308e+08                        │\n│                           6   2020-04-09T05:40:35.748Z  1/0651130834:23676  6.511308e+08                        │\n│                           7   2020-04-09T05:40:36.548Z  1/0651130835:10569  6.511308e+08                        │\n│                           8   2020-04-09T05:40:37.348Z  1/0651130835:62998  6.511308e+08                        │\n│                           9   2020-04-09T05:40:38.148Z  1/0651130836:49891  6.511308e+08                        │\n│                           10  2020-04-09T05:40:38.948Z  1/0651130837:36783  6.511308e+08                        │\n│                           11  2020-04-09T05:40:39.748Z  1/0651130838:23676  6.511308e+08                        │\n│                           12  2020-04-09T05:40:40.548Z  1/0651130839:10569  6.511308e+08                        │\n│                           13  2020-04-09T05:40:41.348Z  1/0651130839:62998  6.511308e+08                        │\n│                           14  2020-04-09T05:40:42.148Z  1/0651130840:49891  6.511308e+08                        │\n│                           15  2020-04-09T05:40:42.948Z  1/0651130841:36783  6.511308e+08                        │\n│                           16  2020-04-09T05:40:43.748Z  1/0651130842:23676  6.511308e+08                        │\n│                           17  2020-04-09T05:40:44.548Z  1/0651130843:10569  6.511308e+08                        │\n│                           18  2020-04-09T05:40:45.348Z  1/0651130843:62998  6.511308e+08                        │\n│                           19  2020-04-09T05:40:46.148Z  1/0651130844:49891  6.511308e+08                        │\n│                           20  2020-04-09T05:40:46.948Z  1/0651130845:36784  6.511308e+08                        │\n│                                                                                                                 │\n│                               HK_STAT_TIS_DATA_ACQ_ID HK_STAT_TIS_DATA_ACQ_TYPE  \\                              │\n│                           0                      3740                   Sci_Raw                                 │\n│                           1                      3743        Sci_Subtracted_BB3                                 │\n│                           2                      3744        Sci_Subtracted_BB3                                 │\n│                           3                      3745        Sci_Subtracted_BB3                                 │\n│                           4                      3746        Sci_Subtracted_BB3                                 │\n│                           5                      3747        Sci_Subtracted_BB3                                 │\n│                           6                      3748        Sci_Subtracted_BB3                                 │\n│                           7                      3749        Sci_Subtracted_BB3                                 │\n│                           8                      3750        Sci_Subtracted_BB3                                 │\n│                           9                      3751        Sci_Subtracted_BB3                                 │\n│                           10                     3752        Sci_Subtracted_BB3                                 │\n│                           11                     3753        Sci_Subtracted_BB3                                 │\n│                           12                     3754        Sci_Subtracted_BB3                                 │\n│                           13                     3755        Sci_Subtracted_BB3                                 │\n│                           14                     3756        Sci_Subtracted_BB3                                 │\n│                           15                     3757        Sci_Subtracted_BB3                                 │\n│                           16                     3758        Sci_Subtracted_BB3                                 │\n│                           17                     3759        Sci_Subtracted_BB3                                 │\n│                           18                     3760        Sci_Subtracted_BB3                                 │\n│                           19                     3761        Sci_Subtracted_BB3                                 │\n│                           20                     3762                   Sci_Raw                                 │\n│                                                                                                                 │\n│                              HK_STAT_TIS_DATA_ACQ_TARGET  HK_STAT_BOL_BIAS_VOLT_ACTIVE_PARAM_SET  \\             │\n│                           0                        Space                                       2                │\n│                           1                        Space                                       2                │\n│                           2                        Space                                       2                │\n│                           3                        Space                                       2                │\n│                           4                        Space                                       2                │\n│                           5                        Space                                       2                │\n│                           6                        Space                                       2                │\n│                           7                        Space                                       2                │\n│                           8                        Space                                       2                │\n│                           9                        Space                                       2                │\n│                           10                       Space                                       2                │\n│                           11                       Space                                       2                │\n│                           12                       Space                                       2                │\n│                           13                       Space                                       2                │\n│                           14                       Space                                       2                │\n│                           15                       Space                                       2                │\n│                           16                       Space                                       2                │\n│                           17                       Space                                       2                │\n│                           18                       Space                                       2                │\n│                           19                       Space                                       2                │\n│                           20                       Space                                       2                │\n│                                                                                                                 │\n│                               HK_STAT_TIS_DATA_ACQ_TIME PAR_TIS_BIN_MODE PAR_TIS_WIN_SIZE  ...  \\               │\n│                           0                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           1                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           2                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           3                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           4                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           5                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           6                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           7                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           8                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           9                6.511308e+08              1x2      100x80pixel  ...                  │\n│                           10               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           11               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           12               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           13               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           14               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           15               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           16               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           17               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           18               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           19               6.511308e+08              1x2      100x80pixel  ...                  │\n│                           20               6.511308e+08              1x2      100x80pixel  ...                  │\n│                                                                                                                 │\n│                              HK_STAT_TIS_COMP_NUM_BANDS  HK_STAT_TIS_NUM_OVERSAMP  HK_TEMP_BOL_CHIP  \\          │\n│                           0                           5                         0            15.000             │\n│                           1                           5                        32            15.000             │\n│                           2                           5                        32            15.003             │\n│                           3                           5                        32            15.002             │\n│                           4                           5                        32            15.001             │\n│                           5                           5                        32            15.002             │\n│                           6                           5                        32            15.001             │\n│                           7                           5                        32            15.002             │\n│                           8                           5                        32            15.001             │\n│                           9                           5                        32            15.000             │\n│                           10                          5                        32            14.999             │\n│                           11                          5                        32            15.000             │\n│                           12                          5                        32            15.000             │\n│                           13                          5                        32            15.001             │\n│                           14                          5                        32            15.000             │\n│                           15                          5                        32            15.000             │\n│                           16                          5                        32            15.000             │\n│                           17                          5                        32            14.998             │\n│                           18                          5                        32            15.001             │\n│                           19                          5                        32            14.997             │\n│                           20                          5                         0            14.999             │\n│                                                                                                                 │\n│                               DAT_TIS_OFFSET_MACRO_PIXEL  HK_TEMP_BOL_HOUSING  HK_TEMP_OST_BASE_PLATE  \\        │\n│                           0                            1                9.527                   9.894           │\n│                           1                         2052                9.519                   9.891           │\n│                           2                         2052                9.519                   9.889           │\n│                           3                         2053                9.520                   9.889           │\n│                           4                         2054                9.520                   9.888           │\n│                           5                         2055                9.519                   9.888           │\n│                           6                         2055                9.519                   9.888           │\n│                           7                         2056                9.520                   9.889           │\n│                           8                         2057                9.520                   9.889           │\n│                           9                         2057                9.521                   9.889           │\n│                           10                        2058                9.520                   9.888           │\n│                           11                        2058                9.520                   9.889           │\n│                           12                        2059                9.522                   9.889           │\n│                           13                        2059                9.522                   9.888           │\n│                           14                        2060                9.522                   9.888           │\n│                           15                        2060                9.523                   9.888           │\n│                           16                        2061                9.523                   9.888           │\n│                           17                        2061                9.524                   9.888           │\n│                           18                        2062                9.524                   9.888           │\n│                           19                        2062                9.525                   9.888           │\n│                           20                           1                9.526                   9.888           │\n│                                                                                                                 │\n│                               PAR_TIS_DATA_NOISE_REDUCTION  HK_STAT_TIS_TOTAL_PACKET_NUM  \\                     │\n│                           0                              0                             1                        │\n│                           1                              0                             1                        │\n│                           2                              0                             1                        │\n│                           3                              0                             1                        │\n│                           4                              0                             1                        │\n│                           5                              0                             1                        │\n│                           6                              0                             1                        │\n│                           7                              0                             1                        │\n│                           8                              0                             1                        │\n│                           9                              0                             1                        │\n│                           10                             0                             1                        │\n│                           11                             0                             1                        │\n│                           12                             0                             1                        │\n│                           13                             0                             1                        │\n│                           14                             0                             1                        │\n│                           15                             0                             1                        │\n│                           16                             0                             1                        │\n│                           17                             0                             1                        │\n│                           18                             0                             1                        │\n│                           19                             0                             1                        │\n│                           20                             0                             1                        │\n│                                                                                                                 │\n│                               HK_STAT_TIS_CURRENT_PACKET_NUM  HK_STAT_TIS_NUM_DATA_WORDS                        │\n│                           0                                1                         384                        │\n│                           1                                1                        1206                        │\n│                           2                                1                        1200                        │\n│                           3                                1                        1208                        │\n│                           4                                1                        1192                        │\n│                           5                                1                        1194                        │\n│                           6                                1                        1204                        │\n│                           7                                1                        1196                        │\n│                           8                                1                        1218                        │\n│                           9                                1                        1200                        │\n│                           10                               1                        1208                        │\n│                           11                               1                        1218                        │\n│                           12                               1                        1214                        │\n│                           13                               1                        1228                        │\n│                           14                               1                        1216                        │\n│                           15                               1                        1214                        │\n│                           16                               1                        1216                        │\n│                           17                               1                        1218                        │\n│                           18                               1                        1218                        │\n│                           19                               1                        1218                        │\n│                           20                               1                         384                        │\n│                                                                                                                 │\n│                           [21 rows x 24 columns]                                                                │\n│                           }                                                                                     │\n│              output_dir = PosixPath('../data/bcmer_tm_all_START-20200409T000000_END-20200410T000000_CRE-202407… │\n│            planet_index = {'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1': Index([], dtype='int64')}         │\n│     planet_index_merged = Index([], dtype='int64')                                                              │\n│        processing_level = 'CAL'                                                                                 │\n│             space_index = {                                                                                     │\n│                               'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1': RangeIndex(start=0, stop=21,   │\n│                           step=1)                                                                               │\n│                           }                                                                                     │\n│      space_index_merged = RangeIndex(start=0, stop=21, step=1)                                                  │\n│             wavelengths = {                                                                                     │\n│                               'mer_cal_sc_tis_20200409_1-0651130819-21186__0_1': array([[13.93365627,           │\n│                           13.93248339, 13.93131051, ..., 13.81988688,                                           │\n│                                   13.818714  , 13.81754112],                                                    │\n│                                  [13.75564164, 13.75446876, 13.75329588, ..., 13.64187226,                      │\n│                                   13.64069938, 13.6395265 ],                                                    │\n│                                  [13.57762702, 13.57645414, 13.57528126, ..., 13.46385764,                      │\n│                                   13.46268476, 13.46151188],                                                    │\n│                                  ...,                                                                           │\n│                                  [ 7.34711524,  7.34594236,  7.34476948, ...,  7.23334586,                      │\n│                                    7.23217298,  7.2310001 ],                                                    │\n│                                  [ 7.16910062,  7.16792774,  7.16675486, ...,  7.05533124,                      │\n│                                    7.05415836,  7.05298548],                                                    │\n│                                  [ 6.991086  ,  6.98991312,  6.98874024, ...,  6.87731661,                      │\n│                                    6.87614373,  6.87497085]], shape=(40, 100))                                  │\n│                           }                                                                                     │\n│          data_assembler = def data_assembler(verbose=False): Assembles the collected data into convenient data  │\n│                           structures.                                                                           │\n│          data_collector = def data_collector(): Collect data from the input files and store it in the           │\n│                           collect_data attribute.                                                               │\n│ detect_processing_level = def detect_processing_level():                                                        │\n│                           Detects the processing level (RAW, CAL, PAR) from the files in the input directory.   │\n│                           Ensures all files have the same level.                                                │\n│          filetypes2dict = def filetypes2dict(): Convert the input files into a dictionary, where the keys are   │\n│                           the file types and the values are lists of file paths.                                │\n│          get_fits_files = def get_fits_files(): Get the list of FITS files.                                     │\n│     get_input_path_dict = def get_input_path_dict(): Get the dictionary of input paths.                         │\n│           listfiletypes = def listfiletypes(): Print the list of file types and the number of files for each    │\n│                           file type.                                                                            │\n│               save_plot = def save_plot(out_file, dpi=150, out_format='jpg'): Save a plot to the output         │\n│                           directory.                                                                            │\n│              set_logger = def set_logger(): Set the logger.                                                     │\n│          set_output_dir = def set_output_dir(output_dir): Set the output directory.                             │\n│              show_files = def show_files(): Print statistics about the files in the input directory.            │\n╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯"
  }
]